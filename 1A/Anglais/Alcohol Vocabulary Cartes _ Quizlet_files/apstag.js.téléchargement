/*! amazon-dtb-javascript-api - apstag - v7.42.00 - 2019-10-31 20:50:57 */
!function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=19)}([function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function o(e){var t=e.length,r=void 0,n=void 0;for(e=[].concat(function(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}(e));0!==t;)n=Math.floor(Math.random()*t),r=e[--t],e[t]=e[n],e[n]=r;return e}function i(e){return"object"===(void 0===e?"undefined":n(e))&&null!==e}function a(){return document.cookie.split("; ").map(function(e){return e.split("=")})}t.shouldSample=function(e){try{var t=parseInt(e,10);if(!isNaN(t)){if(t<=0)return!1;if(100<=t)return!0;if(100*Math.random()<=t)return!0}return!1}catch(e){return!1}},t.getRandomArrayElement=function(e){return o(e)[0]},t.shuffleArray=o,t.chunkArray=function(e,t){var r=parseInt(t,10),n=[],o=0;if(!Array.isArray(e))return n;if("number"!=typeof r||r<1)return[e];for(var i=e.length;o<i;)n.push(e.slice(o,o+=r));return n},t.getRand=function(){return""+Math.round(1e12*Math.random())+Date.now()},t.getRandString=function(e){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=new Array(e),n=0;n<e;n++)r[n]=t[Math.floor(Math.random()*t.length)];return r.join("")},t.isObject=i,t.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)},t.safeObjectHasProp=function(e,t){return i(e)&&Object.prototype.hasOwnProperty.call(e,t)&&void 0!==e[t]&&""!==e[t]},t.hasLocalStorage=function(){var e="amzn_lsTest";try{return window.localStorage.setItem(e,e),window.localStorage.removeItem(e),!0}catch(e){return!1}},t.inArray=function(e,t){return-1!==e.indexOf(t)},t.getCookieParts=a,t.getCookieValue=function(e){var t="";try{t=a().filter(function(t){return t[0]===e})[0][1]}catch(t){}return t},t.getUTCStringForDate=function(e){var t=new Date;return t.setDate(t.getDate()+e),t.toUTCString()},t.getWindowDimensions=function(e){try{return(e.innerWidth||e.document.documentElement.clientWidth||e.document.body.clientWidth)+"x"+(e.innerHeight||e.document.documentElement.clientHeight||e.document.body.clientHeight)}catch(e){}return"x"}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DISPLAY_TARGETING_KEYS=["amznbid","amzniid","amznsz","amznp"],t.VIDEO_TARGETING_KEYS=["amznbid","amzniid","amznp","r_amznbid","r_amzniid","r_amznp"],t.BID_STATES={new:"NEW",exposed:"EXPOSED",set:"SET",rendered:"RENDERED"};var n,o,i,a=t.RB_AID_COOKIE_KEY="__aps_f_aid";t.RB_HOST_COOKIE_KEY="__aps_host",t.RB_MAGIC_NUMBER_FOR_AID_PRESENT=1,t.RB_PAGELOAD_ID_GLOBAL="apsPageloadID",t.IS_GET_BIDS_URL_PARAM={isgb:1},t.DEBUG_LOCAL_STORAGE_KEY="apstagDebug",t.VALID_DEBUG_MODES=["redux","fake_bids","verbose","console","console_v2","errors"],t.DEBUG_CONSOLE_HEIGHT_KEY="apstagDebugHeight",t.DEBUG_GLOBAL="apstagDEBUG",t.CFG_LOCAL_STORAGE_KEY="apstagCfg",t.NO_LOCAL_STORAGE_SUPPORT_MAGIC_NUMBER_FOR_AAX=0,t.MINIMUM_BID_TIMEOUT=0,t.MOCKBID={amznbid:"testBid",amzniid:"testImpression",amznp:"testP",crid:"testCrid"},t.MEDIA_TYPES_MAGIC_STRING_FOR_AAX={video:"v"},t.SLOT_STATE_KEYS=["amznbid","amznp"],t.FIRST_PARTY_COOKIE_KEYS=(i={urlParam:"aidp"},(o=a)in(n={__apsid:{urlParam:"ck"},__aps_id_p:{urlParam:"ckp"},aps_ext_917:{urlParam:"st"}})?Object.defineProperty(n,o,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[o]=i,n),t.SLOT_STATES={noRequest:"0",bidInFlight:"1",noBid:"2"},t.AAX_RESP_REMAP_COOKIE_KEY="cr",t.SELF_SERVE_PUB_SRC="600",t.LIBRARY_VERSION="7.42.00",t.PROTOCOL="https://",t.HAS_XHR_SUPPORT="function"==typeof XMLHttpRequest&&void 0!==(new XMLHttpRequest).withCredentials,t.APSTAG_LOADED_VARIABLE="apstagLOADED"},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.store=void 0;var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e};t.reducer=f,t.resetState=function(){d=!1,p.dispatch({type:"NOOP"})};var o=r(1),i=r(6),a=r(0),s=r(4);function c(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function u(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}var d=void 0,l=[];function f(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=arguments[1];return{AAXReqs:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],t=arguments[1];switch(t.type){case"RECORD_AAX_REQUEST":return[].concat(u(e),[n({},t.data)]);case"RECORD_AAX_RESPONSE_PROP":return e.map(function(e){return(e=n({},e)).bidReqID===t.bidReqID&&(e[t.key]=t.value),e});default:return[].concat(u(e))}}(e.AAXReqs,t),amznCsmParams:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=arguments[1];switch(t.type){case"SET_AMZNCSMPARAMS":return n({},t.amznCsmParams);default:return e}}(e.amznCsmParams,t),bidConfigs:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=arguments[1];switch(t.type){case"RECORD_ORIGINAL_BID_CONFIG":return n({},e,c({},t.bidConfig.bidReqID,n({},t.bidConfig)));default:return n({},e)}}(e.bidConfigs,t),bidReqs:function(){var e,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},r=arguments[1];switch(r.type){case"ADD_CHUNKED_REQUESTS":return n({},t,c({},r.fid,n({},t[r.fid],{networkReqs:new Array(r.numChunks)})));case"NEW_FETCH_BID_REQUEST":return n({},t,c({},r.fid,{pto:r.pto,hasCallbackExecuted:!1}));case"RECORD_CALLBACK":return n({},t,c({},r.fid,n({},t[r.fid],{hasCallbackExecuted:!0})));case"RECORD_NETWORK_EXCHANGE":return n({},t,c({},r.fid,n({},t[r.fid],{networkReqs:n([].concat(u(t[r.fid].networkReqs)),c({},r.networkID,n({},t[r.fid].networkReqs[r.networkID],(e={},c(e,r.exchangeType+"Time",r.timestamp),c(e,"inFlight","request"===r.exchangeType),e))))})));case"RECORD_TIMEOUT":return n({},t,c({},r.fid,n({},t[r.fid],{networkReqs:t[r.fid].networkReqs.map(function(e){return e.inFlight?n({},e,{timeOut:r.timeOut}):e})})));default:return n({},t)}}(e.bidReqs,t),bsPixels:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=arguments[1];switch(t.type){case"RECORD_BID_INFO_SENT":return n({},e,c({},t.bidInfo.iid,t.bidInfo.state));default:return n({},e)}}(e.bsPixels,t),cfg:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{CSM_JS:"//c.amazon-adsystem.com/aax2/csm.js.gz",CSM_RTB_COMMUNICATOR_JS:"//c.amazon-adsystem.com/bao-csm/aps-comm/aps_csm.js",DEBUG_APP_HTML:"//c.amazon-adsystem.com/aax2/debugApp.html",DEBUG_APP_HTML_V2:"//c.amazon-adsystem.com/aax2/debug_app_v2.html",DEFAULT_TIMEOUT:2e3,DTB_PATH:"/e/dtb",PIXEL_PATH:"/x/px/",LATENCY_SAMPLING_RATE:1,COOKIE_MATCH_DELAY:0,MAX_SLOTS_PER_REQUEST:1,CF_ROUTING_RATE:100,SLOT_RENDER_SAMPLING_RATE:1},t=arguments[1];switch(t.type){case"SET_CFG":return n({},e,t.cfg);default:return n({},e)}}(e.cfg,t),cmpFired:function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0];switch(arguments[1].type){case"CMP_FIRED":return!0;default:return e}}(e.cmpFired,t),config:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=arguments[1];switch(t.type){case"SET_CONFIG":return n({},t.config,{gdpr:n({cmpTimeout:t.defaultCmpTimeout},t.config.gdpr),isSelfServePub:t.config.pubID&&5<=t.config.pubID.length});default:return n({},e)}}(e.config,t),displayAdServer:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{noBidSlotIDs:[],shouldSampleRender:!1},t=arguments[1];switch(t.type){case"SLOT_RENDER_ENDED_SET":return n({},e,{slotRenderEndedSet:!0});case"NO_BID_ON_ADSERVER_SLOTS":return n({},e,{noBidSlotIDs:e.noBidSlotIDs.concat(t.slotIDs)});case"REQUESTED_BID_FOR_ADSERVER_SLOTS":return n({},e,{noBidSlotIDs:e.noBidSlotIDs.filter(function(e){return!(0,a.inArray)(t.slotIDs,e)})});case"SHOULD_SAMPLE_SLOT_RENDER":return n({},e,{shouldSampleRender:t.value});default:return n({},e,{noBidSlotIDs:[].concat(u(e.noBidSlotIDs))})}}(e.displayAdServer,t),errors:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],t=arguments[1];switch(t.type){case"LOG_ERROR":return[].concat(u(e),[n({},t.error)]);default:return[].concat(u(e))}}(e.errors,t),eventLog:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],t=arguments[1];switch(t.type){case"LOG_EVENT":return[].concat(u(e),[n({},t.event)]);default:return[].concat(u(e))}}(e.eventLog,t),experiments:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=arguments[1];switch(t.type){case"SHOULD_CHUNK_REQUESTS":return n({chunkRequests:!0===e.shouldSampleLatency&&t.value},e);case"SHOULD_CF_ROUTE":return n({},e,{shouldCFRoute:t.value});case"SHOULD_SAMPLE_LATENCY":return n({},e,{shouldSampleLatency:t.value});default:return n({},e)}}(e.experiments,t),gamSlotFetchLog:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],t=arguments[1];switch(t.type){case"LOG_GAM_EVENT":return[].concat(u(e),[n({},t.event)]);default:return[].concat(u(e))}}(e.gamSlotFetchLog,t),gamSlotRenderPixel:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{aaxReqOffset:0,gamSlotFetchLogOffset:0},t=arguments[1];switch(t.type){case"UPDATE_RENDER_OFFSETS":return n({},e,t.offsets);default:return n({},e)}}(e.gamSlotRenderPixel,t),gdpr:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null,t=arguments[1];switch(t.type){case"SET_GDPR_CONFIG":return null===t.config?null:n({},t.config);default:return null===e?e:n({},e)}}(e.gdpr,t),gdprQue:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],t=arguments[1];switch(t.type){case"ADD_GDPR_QUE_ITEM":return[].concat(u(e),[t.func]);case"CLEAR_GDPR_QUE":return[];default:return[].concat(u(e))}}(e.gdprQue,t),hosts:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{DEFAULT_AAX_BID_HOST:"aax.amazon-adsystem.com",DEFAULT_AAX_PIXEL_HOST:"aax.amazon-adsystem.com"},t=arguments[1];switch(t.type){case"SET_HOST":return n({},e,c({},t.hostName,t.hostValue));default:return n({},e)}}(e.hosts,t),Q:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],t=arguments[1];switch(t.type){case"SET_Q":return[].concat(u(t.Q));default:return[].concat(u(e))}}(e.Q,t),slotBids:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=arguments[1];switch(t.type){case"BID_STATE_CHANGE":return n({},e,c({},t.slotID,e[t.slotID].map(function(e){var r={};return e._targetingSetID===t._targetingSetID&&(r.bidState=t.bidState,t.bidState===o.BID_STATES.rendered?r.renderTime=t.ts:t.bidState===o.BID_STATES.set&&(r.setAtTimes=(0,a.safeObjectHasProp)(e,"setAtTimes")?[].concat(u(e.setAtTimes),[t.ts]):[t.ts])),n({},e,r)})));case"UPDATE_BID_INFO_PROP":return void 0===e[t.slotID]||e[t.slotID].filter(function(e){return(0,i.checkAllPossibleBidCacheIds)(e,t.iid,t.dealId)}).length<1?n({},e):n({},e,c({},t.slotID,e[t.slotID].map(function(e){return e=n({},e),(0,i.checkAllPossibleBidCacheIds)(e,t.iid,t.dealId)&&(e[t.key]=t.value),e})));case"UPDATE_SLOT_BIDS":return n({},e,t.bids.reduce(function(t,r){return(0,a.safeObjectHasProp)(t,r.slotID)?t[r.slotID]=[].concat(u(t[r.slotID]),[n({},r)]):(0,a.safeObjectHasProp)(e,r.slotID)?t[r.slotID]=[].concat(u(e[r.slotID]),[n({},r)]):t[r.slotID]=[n({},r)],t},{}));default:return n({},e)}}(e.slotBids,t),sync917:function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0],t=arguments[1];switch(t.type){case"SET_SYNC_917":return t.value;default:return e}}(e.sync917,t),targetingKeys:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=arguments[1];switch(t.type){case"UPDATE_SLOT_BIDS":return n({},e,t.bids.reduce(function(t,r){return(0,a.safeObjectHasProp)(e,r.slotID)?t[r.slotID]=[].concat(u(e[r.slotID]),u((r.targeting?r.targeting:o.DISPLAY_TARGETING_KEYS).filter(function(t){return-1===e[r.slotID].indexOf(t)}))):t[r.slotID]=r.targeting?r.targeting:o.DISPLAY_TARGETING_KEYS,t},{}));default:return n({},e)}}(e.targetingKeys,t),tests:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=arguments[1];switch(t.type){case"UPDATE_TEST":return n({},e,c({},t.id,{name:t.name,status:t.status,case:t.case}));default:return n({},e)}}(e.tests,t)}}var p={getState:function(){return d},dispatch:function(e){d=f(d,e),l.forEach(function(e){return e()})},subscribe:function(e){l.push(e)}};(0,s.isDebugEnabled)("redux")&&(0,a.hasLocalStorage)()&&(0,a.safeObjectHasProp)(window,"__REDUX_DEVTOOLS_EXTENSION__")&&(t.store=p=window.__REDUX_DEVTOOLS_EXTENSION__(f)),p.dispatch({type:"NOOP"}),t.store=p},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.reportError=m,t.wrapFunction=function(e,t){return function(){try{return e.apply(null,arguments)}catch(e){return m(e,t),null}}},t.consoleWarn=function(e){(1<arguments.length&&void 0!==arguments[1]&&arguments[1]||(0,s.isDebugEnabled)("errors"))&&window[u][l](e)};var n=r(0),o=r(1),i=r(5),a=r(2),s=r(4),c=(0,n.shouldSample)(10),u="console",d="error",l="warn",f=void 0,p=void 0,g=[];function m(e,t,r){try{(r||(0,s.isDebugEnabled)("errors"))&&window[u][d](e);var n={lv:o.LIBRARY_VERSION,ts:Date.now(),url:encodeURIComponent(window.document.documentURI),r:encodeURIComponent(window.document.referrer),_type:"apsLibraryError",e:{et:e.name,el:t,msg:e.message}};if(void 0===f){var l=a.store.getState();void 0!==l&&void 0!==l.config&&(f=l.config.isSelfServePub,p=l.config.pubID)}return void 0!==f&&(f?(n.src=o.SELF_SERVE_PUB_SRC,n.pubid=p):n.src=p),g.push(n),a.store.dispatch({type:"LOG_ERROR",error:n}),!!c&&((0,i.noBidCacheIdPixel)(n),!0)}catch(e){}return!1}!0===(0,s.getDebugValue)("exposeErrors")&&(window.apstagErrors=g)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.debugPublicApi=function(e,t,r){switch(-1!==u.indexOf(e)&&((0,c.reportError)("Debug call made: "+e,"__apstag-debug-call-"+e+"__"),u=u.filter(function(t){return t!==e})),e){case"getLog":return n.store.getState().eventLog;case"getState":return n.store.getState();case"enable":return I("fake_bids",!0),"DEBUG MODE ENABLED";case"disable":return I("fake_bids",!1),"DEBUG MODE DISABLED";case"enableConsole":return g(!1,"command"),"Debug console enabled";case"enableConsoleV2":return g(!0,"command"),"Debug console v2 enabled";case"disableConsole":return m(),"Debug console disabled";case"setDebug":return I(t,r)?"Set debug mode '"+t+"' to '"+r+"'":"Failed to set debug mode '"+t+"' to '"+r+"'";default:return"unknown debug argument"}},t.enableDebugConsole=g,t.disableDebugConsole=m,t.isDebugEnabled=O,t.setDebugMode=I,t.getDebugValue=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;return"undefined"!=typeof window&&(0,o.safeObjectHasProp)(window,i.DEBUG_GLOBAL)&&(0,o.safeObjectHasProp)(window[i.DEBUG_GLOBAL],e)?window[i.DEBUG_GLOBAL][e]:t},t.pixelDebugModes=A;var n=r(2),o=r(0),i=r(1),a=r(7),s=r(5),c=r(3),u=["getLog","getState"],d=null,l=null,f=null,p=null;function g(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0],t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;if(I(e?"console_v2":"console",!0),null===d){var r={url:e?n.store.getState().cfg.DEBUG_APP_HTML_V2:n.store.getState().cfg.DEBUG_APP_HTML,onload:_,onerror:console.error};(0,a.xhrGet)(r),setTimeout(function(){var r={_type:"debugLoad",mode:e?2:1},o=n.store.getState().config.pubID;void 0!==o&&(r.src=o),null!==t&&(r.method=t),(0,s.noBidCacheIdPixel)(r)},5e3)}}function m(){I("console",!1),I("console_v2",!1),null!==d&&document.body.removeChild(d),f=l=d=null,(0,o.hasLocalStorage)()&&window.localStorage.removeItem(i.DEBUG_CONSOLE_HEIGHT_KEY)}function _(e){var t=e.responseText;d=document.createElement("div"),l=document.createElement("div"),f=document.createElement("iframe");var r=200;O("console_v2")&&(r=330),(0,o.hasLocalStorage)()&&null!==window.localStorage.getItem(i.DEBUG_CONSOLE_HEIGHT_KEY)&&(r=window.localStorage.getItem(i.DEBUG_CONSOLE_HEIGHT_KEY)),r>window.innerHeight&&(r=200),d.style="background: #eaeded;z-index: 2147483647;bottom: 0;position: fixed !important;display: block !important;left: 0;right: 0;height: "+r+"px;",l.style="cursor: row-resize;height: 2px;position: absolute;top: 0;left: 0;right: 0;background-color: RGBA(0,0,0,0);",d.appendChild(l),f.frameBorder=0,f.marginHeight=0,f.marginWidth=0,f.topMargin=0,f.leftMargin=0,f.scrolling="no",f.allowTransparency=!0,f.id="apstag-debug-iframe",f.src="about:blank",f.style="display: block; width: 100%; height: "+r+"px;",d.appendChild(f),document.body.appendChild(d),f.contentDocument.open(),f.contentDocument.write(t),f.contentDocument.close(),l.addEventListener("mousedown",S)}function b(e){var t=window.innerHeight-e.clientY;return t<200&&(t=200),d.style.height=t+"px",f.style.height=t+"px",t}function h(e){return e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault(),e.cancelBubble=!0,e.returnValue=!1}function S(){(p=document.createElement("div")).style="position: fixed; left: 0; right: 0; top: 0; bottom: 0; z-index: 9999999999;",d.appendChild(p),window.addEventListener("mouseup",v),window.addEventListener("mousemove",y)}function y(e){return b(e),h(e)}function v(e){null!==p&&(d.removeChild(p),p=null),window.removeEventListener("mousemove",y),window.removeEventListener("mouseup",v);var t=b(e);return(0,o.hasLocalStorage)()&&window.localStorage.setItem(i.DEBUG_CONSOLE_HEIGHT_KEY,t),h(e)}function E(){if(!(0,o.hasLocalStorage)())return[];var e=window.localStorage.getItem(i.DEBUG_LOCAL_STORAGE_KEY);null===e||"false"===e?e="[]":"true"===e&&(e='["fake_bids"]');var t=void 0;try{t=JSON.parse(e)}catch(e){}return(0,o.isArray)(t)||(t=[]),t.filter(function(e){return-1!==i.VALID_DEBUG_MODES.indexOf(e)})}function O(e){return(0,o.inArray)(E(),e)}function I(e,t){if(!(0,o.hasLocalStorage)())return!1;if(-1===i.VALID_DEBUG_MODES.indexOf(e))return!1;var r=E();return t&&-1===r.indexOf(e)?r.push(e):t||(r=r.filter(function(t){return t!==e})),0===r.length?window.localStorage.removeItem(i.DEBUG_LOCAL_STORAGE_KEY):window.localStorage.setItem(i.DEBUG_LOCAL_STORAGE_KEY,JSON.stringify(r)),A(),!0}var D=[];function A(){try{E().filter(function(e){return-1===D.indexOf(e)}).forEach(function(e){(0,c.reportError)(new Error("Debug method enabled: "+e),"__error-debug-mode-"+e+"__",!0),D.push(e)})}catch(e){(0,c.reportError)(e,"__error-debug-pixeled__",!0)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.pixels=t.pixelQueue=void 0,t.sendPixel=l,t.noBidCacheIdPixel=function(e){return l(d()+"p/PH/"+u(e))},t.bidCacheIdPixel=function(e,t){return l(""+d()+e+"/"+u(t))},t.sendPixels=function(){s||(s=!0,a.forEach(l))},t.resetSendPixels=function(){s=!1,t.pixels=c=[],t.pixelQueue=a=[]};var n=r(1),o=r(2),i=r(4),a=t.pixelQueue=[],s=!1,c=t.pixels=[];function u(e){e._tl="aps-tag";var t=JSON.stringify(e);return t=t.replace(/\\.{1}/g,""),encodeURIComponent(t)}function d(){var e=o.store.getState(),t=e.cfg.PIXEL_PATH,r=e.hosts.DEFAULT_AAX_PIXEL_HOST;return""+n.PROTOCOL+r+t}function l(e){if(s){var t=new Image;return t.src=e,c.push(t),t}return a.push(e),e}!0===(0,i.getDebugValue)("exposePixels")&&(window.apstagPixelQueue=a,window.apstagPixelsSent=c)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getAmpAmznBidValue=function(e){return"string"==typeof e?e.split("_").pop():""},t.checkAllPossibleBidCacheIds=function(e,t,r){return e.amzniid===t||e[r+"amzniid"]===t||e.amzniid_sp===t},t.isAAXPunt=function(e){return!(0,o.safeObjectHasProp)(e,"slots")},t.getCurrentUrl=function(e){var t=(0,n.getDebugValue)("url");if(null!==t)return encodeURIComponent(t);var r=void 0;try{r=e.top.location.href}catch(e){r=null}if(null===r||!r||void 0===r){r="";try{e.top!==e.self&&(r=e.document.referrer)}catch(e){}}return encodeURIComponent(r)},t.getReferrerUrl=function(e){var t="",r=void 0;try{try{r=e.top.document.referrer}catch(t){r=e.document.referrer}t=encodeURIComponent(r)}catch(t){(0,i.reportError)(t,"__error-getPageReferrerURL__")}return t},t.getApsFirstPartyCookies=function(){var e={cookiesParams:""};return(0,o.getCookieParts)().forEach(function(t){if(t[0]in a.FIRST_PARTY_COOKIE_KEYS)switch(t[0]){case"aps_ext_917":e.fb=t[1];break;case a.RB_AID_COOKIE_KEY:e.cookiesParams+="&"+a.FIRST_PARTY_COOKIE_KEYS[a.RB_AID_COOKIE_KEY].urlParam+"="+a.RB_MAGIC_NUMBER_FOR_AID_PRESENT;break;default:e.cookiesParams+="&"+a.FIRST_PARTY_COOKIE_KEYS[t[0]].urlParam+"="+t[1]}}),e.fb||s.store.getState().sync917||s.store.dispatch({type:"SET_SYNC_917",value:!0}),e},t.getBlockedBidders=function(e){var t=s.store.getState().config.blockedBidders;return(0,o.safeObjectHasProp)(e,"blockedBidders")&&(0,o.isArray)(e.blockedBidders)&&(t=e.blockedBidders),(0,o.isArray)(t)&&(t=JSON.stringify(t)),t},t.getCfgVersion=function(){if(!(0,o.hasLocalStorage)())return a.NO_LOCAL_STORAGE_SUPPORT_MAGIC_NUMBER_FOR_AAX;var e=s.store.getState();return(0,o.safeObjectHasProp)(e,"cfg")&&(0,o.safeObjectHasProp)(e.cfg,"v")?e.cfg.v:null},t.getDisplayAdServerSlots=function(e){var t=[];try{e.hasAdServerObjectLoaded()&&(t=e.getSlots())}catch(e){(0,i.reportError)(e,"getDisplayAdServerSlots")}return t};var n=r(4),o=r(0),i=r(3),a=r(1),s=r(2)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.xhrGet=function(e){var t=e.url,r=e.onload,o=e.onerror,i=void 0===o?null:o,a=e.ontimeout,s=void 0===a?null:a,c=e.withCredentials,u=void 0===c?null:c;try{var d=new window.XMLHttpRequest;d.onload=r.bind(null,d),null!==i&&(d.onerror=i),null!==s&&(d.ontimeout=s),null!==u&&(d.withCredentials=u),d.open("GET",t),d.send(null)}catch(e){(0,n.reportError)(e,"__xhrGet__")}},t.loadScriptTag=function(e,t){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;try{if(null===r&&(r=document),void 0===e)return"function"==typeof t&&t(!0),!1;var i=r.getElementsByTagName("script")[0]||r.body.firstChild,a=r.createElement("script");return a.type="text/javascript",a.async=!0,a.src=e,t&&o(a,t),i.parentNode.insertBefore(a,i),!0}catch(e){return(0,n.reportError)(e,"__loadScriptTag__",!0),!1}},t.addOnLoadFunction=o,t.objToUrlParam=function(e){return encodeURIComponent(JSON.stringify(e))};var n=r(3);function o(e,t){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:[];try{return"function"==typeof t&&(e.readyState?e.onreadystatechange=function(){-1!==["loaded","complete"].indexOf(e.readyState)&&(e.onreadystatechange=null,t.apply(null,r))}:e.onload=function(){t.apply(null,r)},!0)}catch(e){return(0,n.reportError)(e,"__addOnLoadFunction__"),!1}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GDPR=t.cmpLocalStorageChanged=t.cmpResponseKey=void 0;var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},i=r(0),a=r(3);Number.isInteger=Number.isInteger||function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e};var s=t.cmpResponseKey="cmpRTimesA",c=t.cmpLocalStorageChanged="crfgL0cSt0rC";t.GDPR=function(e,t){e=o({},e);var r,u,d=void 0,l=50,f=[1,1,3,5],p=0,g=!1,m="crfgL0cSt0r",_=!1,b="cmp-timeout";try{t=(0,a.wrapFunction)(t,"GdprCallback");var h=function(e){try{e=o({},e),Object.keys(e.log).map(function(t){"string"==typeof e.log[t]&&-1!==e.log[t].indexOf("/")&&(e.log[t]=encodeURIComponent(e.log[t]))}),e.log=JSON.stringify(e.log)}catch(e){(0,a.reportError)(e,"__gdpr_stringify_log__",!0)}t(e)};"object"===(void 0===e?"undefined":n(e))&&null!==e||(e={});var S={cmpGlobal:e.cmpGlobal,cmpTimeout:e.cmpTimeout,enabled:e.enabled};!1===e.enabled?S.status="explicit-no-gdpr":!0===e.enabled&&(S.status=void 0!==e.consent?"explicit-consent-passed":"explicit-no-consent-passed"),(0,i.hasLocalStorage)()&&(_=function(){try{var e=window.localStorage.getItem(m);return null!==e&&JSON.parse(e)}catch(e){return(0,a.reportError)(e,"__gdpr_parse_ls__"),!1}}()),!1!==_&&(void 0===window.document.cookie||-1===window.document.cookie.indexOf(m+"=true")?(_=!1,S.lsStatus="invalid"):(S.lsStatus="present",l=50,b="cmp-timeout-cfb")),"string"!=typeof e.cmpGlobal&&(e.cmpGlobal="__cmp"),Number.isInteger(e.cmpTimeout)||(e.cmpTimeout=l);var y=(u={log:S},void 0===(r=e).enabled||(!1===r.enabled?u.enabled=0:(Number.isInteger(r.enabled)?u.enabled=r.enabled:u.enabled=1,"string"==typeof r.consent&&(u.consent=r.consent))),u);if(void 0!==y.enabled)return void h(y);!1!==_&&(y=o({},_,y)),!1===_||_.enabled===y.enabled&&_.consent===y.consent||(S.lsStatus="pub-override"),function e(t,r){if(!(0,i.safeObjectHasProp)(window,t.cmpGlobal)||"function"!=typeof window[t.cmpGlobal])return r({error:"no-cmp"}),void(p<f.length&&(setTimeout(e,1e3*f[p],t,r),p++));setTimeout(r,t.cmpTimeout,{timeout:!0},!0),d=Date.now();try{window[t.cmpGlobal]("getConsentData",null,r)}catch(e){r({error:"cmp-internal-error"}),(0,a.reportError)(e,"__gdpr_cmp__",!0)}}(e,function(e,t,r){if(!g||"object"!==(void 0===t?"undefined":n(t))||null===t||!t.timeout){g=!0;try{return"object"===(void 0===t?"undefined":n(t))&&null!==t&&void 0!==t.error?(S.status=t.error,void h(e)):r&&"object"===(void 0===t?"undefined":n(t))&&null!==t?t.timeout?(S.status=b,void h(e)):(function(e){if((0,i.hasLocalStorage)())try{var t=window.localStorage.getItem(s);(t=null!==t?JSON.parse(t):[]).push(e),window.localStorage.setItem(s,JSON.stringify(t))}catch(e){(0,a.reportError)(e,"__gdpr_save_time__")}}(Date.now()-d),S.status="success",t.gdprApplies?(e.enabled=1,e.consent=t.consentData):(e.enabled=0,delete e.consent),function(e){try{if(!(0,i.hasLocalStorage)())return;window.localStorage.setItem(c,"0"),!1!==_&&_.enabled===e.enabled&&_.consent===e.consent||(window.localStorage.setItem(c,"2"),window.localStorage.setItem(m,JSON.stringify({enabled:e.enabled,consent:e.consent})),!1!==_&&(S.lsStatus="cmp-override",window.localStorage.setItem(c,"1"))),window.document.cookie=m+"=true;max-age=604800"}catch(e){return void(0,a.reportError)(e,"__gdpr_save__")}}(e),void h(e)):(S.status="cmp-error",void h(e))}catch(t){return(0,a.reportError)(t,"__gdpr_cmp_callback__",!0),S.status="func-error",void h(e)}}}.bind(null,y))}catch(e){g||t({log:'{"status":"global-func-error"}'}),g=!0,(0,a.reportError)(e,"__gdpr_global_func__",!0)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getMetricFromPerformanceObject=i,t.getResourcePerformanceObject=function(e,t){try{var r=a(e,t)[0];return void 0===r?null:r}catch(e){return null}},t.getPerformanceResourceObjects=a,t.getWindowPerformanceMetric=function(e,t){try{var r=e.performance.timing[t];return void 0===r?o:r}catch(e){return o}},t.isResourceCached=function(e){try{if(0===["redirectStart","redirectEnd","domainLookupStart","domainLookupEnd","connectStart","connectEnd","requestStart","responseStart","secureConnectionStart"].reduce(function(t,r){return t+i(e,r)},0))return null;var t=i(e,"fetchStart");return["domainLookupStart","domainLookupEnd","connectStart","connectEnd"].reduce(function(r,n){return r&&i(e,n)===t},!0)}catch(e){return null}},t.getTimeOrigin=function(){try{var e=window.performance.timeOrigin;return void 0===e&&(e=window.performance.timing.navigationStart),e}catch(e){return o}},t.getURLLengthFromPerformanceObject=function(e){var t=0;if((0,n.isObject)(e)){var r=e.name;"string"==typeof r&&(t=r.length)}return t};var n=r(0),o=0;function i(e,t){try{return"number"!=typeof e[t]?o:Math.round(e[t])}catch(e){return o}}function a(e,t){try{return e.performance.getEntriesByType("resource").filter(function(e){return-1!==e.name.indexOf(t)})}catch(e){return[]}}},,,function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.displayAdServerGoogletag=void 0;var n=r(0),o={isSupported:!0,needNewBidObject:!1,cmdQueuePush:function(e){googletag.cmd.push(e)},setTargeting:function(e,t,r){void 0===r?googletag.pubads().setTargeting(e,t):r.setTargeting(e,t)},getTargeting:function(e,t){return void 0===t?googletag.pubads().getTargeting(e):t.getTargeting(e)},clearTargeting:function(e,t){void 0===t?googletag.pubads().clearTargeting(e):t.clearTargeting(e)},slotRenderEndedEvent:function(e){googletag.pubads().addEventListener("slotRenderEnded",e)},hasAdServerObjectLoaded:function(){return"undefined"!=typeof googletag&&(0,n.safeObjectHasProp)(googletag,"apiReady")&&!0===googletag.apiReady},isCommandQueueDefined:function(){return"undefined"!=typeof googletag&&void 0!==googletag.cmd},getSlotElementId:function(e){return e.getSlotElementId()},getSlots:function(){return googletag.pubads().getSlots()},appendTargeting:function(){}};t.displayAdServerGoogletag=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IS_RENDER_BIDDING_PAGELOAD=void 0,t.getPageLoadID=function(){return u?window[n.RB_PAGELOAD_ID_GLOBAL]:(0,o.getRandString)(s)},t.setRenderBiddingHosts=function(){var e=c(a)?a:"aax";i.store.dispatch({type:"SET_HOST",hostName:"DEFAULT_AAX_BID_HOST",hostValue:e+".amazon-adsystem.com"}),i.store.dispatch({type:"SET_HOST",hostName:"DEFAULT_AAX_PIXEL_HOST",hostValue:e+".amazon-adsystem.com"})},t.isFirstAAXRequest=function(e){return 1===e.AAXReqs.length},t.isRenderBiddingGetBidsRequest=function(e){return-1!==e.indexOf(n.IS_GET_BIDS_URL_PARAM)},t.injectCBForGetBids=function(e,t){if(-1<t.indexOf('"cb":'))return t;var r=t.split(/\}\)$/),n=e.split("?")[1].split("&").filter(function(e){return-1<e.indexOf("cb=")})[0].split("=")[1];return r[0]+(-1<t.indexOf("{}")?"":",")+'"cb":"'+n+'"})'};var n=r(1),o=r(0),i=r(2),a=(0,o.getCookieValue)(n.RB_HOST_COOKIE_KEY),s=13;function c(e){return""!==e}var u=t.IS_RENDER_BIDDING_PAGELOAD=(0,o.safeObjectHasProp)(window,n.RB_PAGELOAD_ID_GLOBAL)&&c(a)},,,,,,function(e,t,r){e.exports=r(20)},function(e,t,r){"use strict";var gt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},mt=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},n=r(21),_t=i(n),St=r(8),bt=r(2),yt=r(6),ht=r(0),vt=r(4),Et=r(1),Ot=r(9),At=r(22),Dt=r(5),It=r(3),Tt=r(7),Pt=r(12),Rt=r(13),o=r(23),wt=r(24),Ct=r(28);function i(e){return e&&e.__esModule?e:{default:e}}function zt(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Lt(e,t){var r={};for(var n in e)0<=t.indexOf(n)||Object.prototype.hasOwnProperty.call(e,n)&&(r[n]=e[n]);return r}try{var a=(0,o.isApstagLibrary)(window.apstag);a?(0,It.reportError)(new Error("apstag has already loaded - preventing duplicate load"),"__error-apstag_duplicate_load__",!0):((0,o.hasApstagJsLoaded)(window)&&(0,It.reportError)(new Error("apstag was loaded and then destroyed"),"__error-apstag-destroyed-reloaded__",!0),window[Et.APSTAG_LOADED_VARIABLE]=!0,function(){var n=(0,Ot.getWindowPerformanceMetric)(window,"navigationStart"),a=(0,Rt.getPageLoadID)(),e="ls",t=(0,vt.isDebugEnabled)("console")||function(){try{return-1!==window.location.href.indexOf("amzn_debug_console=1")&&(e="url",!0)}catch(e){return!1}}(),r=(0,vt.isDebugEnabled)("console_v2")||function(){try{return-1!==window.location.href.indexOf("amzn_debug_console=2")&&(e="url",!0)}catch(e){return!1}}();!function(){if((0,ht.hasLocalStorage)()){var e=localStorage.getItem(Et.CFG_LOCAL_STORAGE_KEY);if(e&&"undefined"!==e){var t=JSON.parse(e);bt.store.dispatch({type:"SET_CFG",cfg:t})}}}();var f=(o={},i=Date.now(),s=0,{addTimer:function(e,t){t=t||Date.now(),o[e]=t-i},set:function(e,t){o[e]=t},schedule:function(e,t){e=e||5e3,setTimeout(function(){o.i=s,o.t0=i,o.site=function(){var e=decodeURIComponent((0,yt.getCurrentUrl)(window));return(-1<e.indexOf("://")?e.split("/")[2]:e.split("/")[0]).split(":")[0]}(),(0,Dt.noBidCacheIdPixel)(o),o={},i=Date.now(),s++},e)}}),o,i,s;function c(e){e.ts=Date.now(),bt.store.dispatch({type:"LOG_EVENT",event:e})}function u(e){function t(e){if(!bt.store.getState().cmpFired){bt.store.dispatch({type:"CMP_FIRED"});var t=document.createElement("iframe");t.style.display="none",t.src=e,document.body.appendChild(t)}}document.readyState&&"loading"===document.readyState?document.addEventListener?document.addEventListener("DOMContentLoaded",function(){t(e)},!1):document.attachEvent&&document.attachEvent("onreadystatechange",function(){"complete"===document.readyState&&t(e)}):t(e)}function d(e){try{var t=bt.store.getState().cfg.COOKIE_MATCH_DELAY;setTimeout(function(){try{e&&e.cmp&&""!==e.cmp&&void 0!==e.cmp?u(e.cmp):e&&e.cmpjs&&""!==e.cmpjs&&void 0!==e.cmpjs&&(0,Tt.loadScriptTag)(e.cmpjs)}catch(e){(0,It.reportError)(e,"__error-tryCookieMatch-1__")}},t)}catch(e){(0,It.reportError)(e,"__error-tryCookieMatch-2__")}}function l(e){if(!e)return!1;try{var t=Math.floor(Number(e));if(t>Et.MINIMUM_BID_TIMEOUT)return t}catch(e){return(0,It.reportError)(e,"__error-getValidMilliseconds__",!0),!1}return!1}function p(e){return!bt.store.getState().experiments.chunkRequests||0===bt.store.getState().bidReqs[e.split("-")[0]].networkReqs.filter(function(e){return e.inFlight}).length}function g(e,t){!bt.store.getState().bidReqs[e[0]].hasCallbackExecuted&&p(e[0])&&(bt.store.dispatch({type:"RECORD_CALLBACK",fid:e[0]}),t())}function m(e){bt.store.getState().experiments.chunkRequests&&bt.store.dispatch({type:"RECORD_NETWORK_EXCHANGE",fid:e[0],timestamp:Date.now(),exchangeType:"response",networkID:e[1]})}function _(r,n,e){var o=e.split("-"),t={url:r,withCredentials:!0};try{t.onload=function(e){m(o);var t=e.responseText;(0,Rt.isRenderBiddingGetBidsRequest)(r)&&(t=(0,Rt.injectCBForGetBids)(r,t)),eval(t),g(o,n)},t.onerror=function(){m(o),g(o,n)},(0,Tt.xhrGet)(t)}catch(e){(0,It.reportError)(e,"__error-xhrBid__",!0),m(o),g(o,n)}}function S(e){var t=new Date;return t.setTime(t.getTime()+1e3*e),t.toGMTString()}function b(e){if(e[Et.AAX_RESP_REMAP_COOKIE_KEY])try{e[Et.AAX_RESP_REMAP_COOKIE_KEY].forEach(function(e){document.cookie=e.k+"="+e.v+";expires="+(-1!==e.exp?S(e.exp):(0,ht.getUTCStringForDate)(365))+";path=/;"})}catch(e){(0,It.reportError)(e,"__error-setFirstPartyCookies__")}}function y(e){(0,ht.safeObjectHasProp)(e,"cb")&&(bt.store.dispatch({type:"RECORD_AAX_RESPONSE_PROP",bidReqID:e.cb,key:"resTs",value:Date.now()}),bt.store.dispatch({type:"RECORD_AAX_RESPONSE_PROP",bidReqID:e.cb,key:"perf",value:(0,Ot.getResourcePerformanceObject)(window,e.cb)})),(0,ht.safeObjectHasProp)(e,"cfg")&&bt.store.dispatch({type:"SET_CFG",cfg:e.cfg}),f.addTimer("br"),f.set("brs",(0,yt.isAAXPunt)(e)?"0":"1"),(0,ht.safeObjectHasProp)(e,"rm")&&f.schedule(e.to,e.id),ce(e)}function h(e){if(d(e),b(e),(0,ht.safeObjectHasProp)(e,"cfg")&&localStorage.setItem(Et.CFG_LOCAL_STORAGE_KEY,JSON.stringify(e.cfg)),(0,ht.safeObjectHasProp)(e,"st")&&e.st.includes(917)&&bt.store.getState().sync917){bt.store.dispatch({type:"SET_SYNC_917",value:!1});try{k()}catch(e){(0,It.reportError)(e,"__error-doFbSync__")}}v(e),(0,yt.isAAXPunt)(e)||(0,Dt.sendPixels)()}function v(e){if((0,ht.safeObjectHasProp)(e,"fp")){var t=e.fp;(0,ht.safeObjectHasProp)(t,"length")&&t.forEach(function(e){var t=e.d?e.d:0;setTimeout(function(){(0,Dt.sendPixel)(e.s)},t)})}}function E(e,t){function r(t){if(!n){try{e(t),o&&clearTimeout(o)}catch(t){(0,It.reportError)(t,"__error-wrapCallback__",!0)}n=!0}}var n=!1,o=null;return o=setTimeout(r.bind(null,!0),t||bt.store.getState().cfg.DEFAULT_TIMEOUT),r.bind(null,!1)}function O(){bt.store.getState().Q.forEach(function(e){"i"===e[0]?window.apstag.init.apply(null,e[1]):window.apstag.fetchBids.apply(null,e[1])})}function A(e){var t=bt.store.getState().config;return(0,ht.safeObjectHasProp)(t,"pubID")&&(0,ht.safeObjectHasProp)(e,"pubID")&&t.pubID!==e.pubID&&(0,It.reportError)(new Error("`apstag.init` was called multiple times with different pubIDs ("+t.pubID+" then "+e.pubID+")"),"__error-init-multiple-calls__",!0),bt.store.dispatch({type:"SET_GDPR_CONFIG",config:null}),bt.store.dispatch({type:"SET_CONFIG",config:e,defaultCmpTimeout:bt.store.getState().cfg.GDPR_CMP_TIMEOUT}),"success"}function D(){var e=bt.store.getState();return(0,ht.safeObjectHasProp)(e,"config")&&(0,ht.safeObjectHasProp)(e.config,"deals")&&!0===e.config.deals||wt.displayAdServer.needNewBidObject}function I(e){var t=e.slotID;(0,ht.safeObjectHasProp)(e,"mediaType")&&"video"===e.mediaType||wt.displayAdServer.hasAdServerObjectLoaded()&&wt.displayAdServer.isCommandQueueDefined()&&(wt.displayAdServer.hasAdServerObjectLoaded()?T(t)&&M(e):wt.displayAdServer.cmdQueuePush(function(){I(e)}))}function T(e){var t;try{t=(0,yt.getDisplayAdServerSlots)(wt.displayAdServer).filter(function(t){return wt.displayAdServer.getSlotElementId(t)===e})[0]}catch(t){(0,It.reportError)(t,"__error-getAdServerSlot__")}return t}function P(e){try{var t=bt.store.getState().targetingKeys[e];if(wt.displayAdServer.hasAdServerObjectLoaded()&&(0,ht.isArray)(t)){var r=T(e);t.forEach(function(e){0<wt.displayAdServer.getTargeting(e,r).length&&wt.displayAdServer.clearTargeting(e,r)})}}catch(e){(0,It.reportError)(e,"__error-clearTargetingFromSlot__")}}function R(e){try{if((0,ht.safeObjectHasProp)(bt.store.getState().slotBids,e)){var t=bt.store.getState().slotBids[e].filter(function(e){return e.bidState===Et.BID_STATES.set})[0];t&&t.bidState===Et.BID_STATES.set&&bt.store.dispatch({type:"BID_STATE_CHANGE",slotID:e,_targetingSetID:t._targetingSetID,bidState:Et.BID_STATES.exposed})}}catch(e){(0,It.reportError)(e,"__error-clearbidSetOnSlot__")}}function w(e,t){return decodeURIComponent(e).split("?")[0].split("#")[0]===decodeURIComponent(t).split("?")[0].split("#")[0]}function C(e,t){return e.map(function(e){return(0,ht.inArray)(t,e)}).filter(function(e){return e}).length===e.length}function z(){var e={};try{Object.keys(bt.store.getState().slotBids).forEach(function(t){if(-1===bt.store.getState().displayAdServer.noBidSlotIDs.indexOf(t)){var r=bt.store.getState().slotBids[t].filter(function(e){return Date.now()-bt.store.getState().AAXReqs.filter(function(t){return t.bidReqID===e.bidReqID})[0].rqTs<24e4}).filter(function(e){return w((0,yt.getCurrentUrl)(window),bt.store.getState().AAXReqs.filter(function(t){return t.bidReqID===e.bidReqID})[0].url)}).filter(function(e){return e.bidState!==Et.BID_STATES.rendered});0<r.length&&(e[t]=r.map(function(e){var t=bt.store.getState().AAXReqs.filter(function(t){return t.bidReqID===e.bidReqID})[0].rqTs;return mt({},e,{rqTs:t})}).reduce(function(e,t){return e.rqTs>t.rqTs?e:t}))}})}catch(e){(0,It.reportError)(e,"__error-getCurrentSlotBids__")}return e}function L(e,t){return(0,ht.isArray)(bt.store.getState().targetingKeys[e])?t?["amzniid_sp"]:bt.store.getState().targetingKeys[e].filter(function(e){return-1<e.indexOf("amzniid")&&e.indexOf("amzniid_sp")<0}):["amzniid"]}function j(e,t){var r,n;try{var o=bt.store.getState().slotBids;Object.keys(o).forEach(function(i){o[i].forEach(function(o){L(i,t).forEach(function(t){o[t]===e&&(r=o,"amzniid_sp"===t?n="sp":"amzniid"!==t&&(n=t.substr(0,t.indexOf("amzniid"))))})})})}catch(e){(0,It.reportError)(e,"__error-findSlotBidByBidID__",!0)}return{slotBid:r,dealId:n}}function B(e,t,r){var n;return t[r+"amzniid"]===e&&(n=r.split("_").pop().trim()),n}function x(e){var t={};return e.slots.forEach(function(e){"video"!==e.mediaType?t[e.slotID]=e:(0<=e.slotID.indexOf("rsv-")&&(e={slotID:e.slotID.substring(4),r_amznbid:e.amznbid,r_amzniid:e.amzniid,r_amznp:e.amznp,mediaType:"video",targeting:["r_amznbid","r_amzniid","r_amznp"]}),t[e.slotID]?(e.targeting=e.targeting.concat(t[e.slotID].targeting),t[e.slotID]=mt({},t[e.slotID],e)):t[e.slotID]=e)}),Object.keys(t).map(function(e){return t[e]})}function N(e){var t,r=x(e),n=["host","ev","cb","cmp","cfe"];try{t=r.map(function(t){var r={bidState:Et.BID_STATES.new,_targetingSetID:(0,ht.getRand)()};return(0,ht.safeObjectHasProp)(t,"amznsz")||(r.amznsz=t.size),n.forEach(function(t){if((0,ht.safeObjectHasProp)(e,t)){var n=e[t],o=t;"cb"===t&&(o="bidReqID"),r[o]=n}}),mt({},t,r)})}catch(t){(0,It.reportError)(t,"__error-convertAAXResponse__")}return t}function M(e){try{var t,r=e.slotID,n=e._targetingSetID,o=e.targeting?e.targeting:dt("display");if(e.bidState===Et.BID_STATES.set)return;(t=T(r))&&(R(r),Object.keys(e).filter(function(e){return(0,ht.inArray)(o,e)}).forEach(function(r){return wt.displayAdServer.setTargeting(r,e[r],t)}),bt.store.dispatch({type:"BID_STATE_CHANGE",slotID:r,_targetingSetID:n,bidState:Et.BID_STATES.set,ts:Date.now()}))}catch(r){(0,It.reportError)(r,"__error-applyTargetingToAdServerSlot__")}}function H(e){var t=z();e.forEach(function(e){t[e]&&I(t[e])})}function U(){var e=z();Object.keys(e).forEach(function(t){I(e[t])})}function G(e){try{e?H(e):U(),bt.store.getState().displayAdServer.slotRenderEndedSet||(wt.displayAdServer.cmdQueuePush(function(){wt.displayAdServer.slotRenderEndedEvent(function(e){P(wt.displayAdServer.getSlotElementId(e.slot)),R(wt.displayAdServer.getSlotElementId(e.slot))})}),bt.store.dispatch({type:"SLOT_RENDER_ENDED_SET"}))}catch(e){(0,It.reportError)(e,"__error-applySlotTargeting__",!0)}}function k(){var e=197,t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r="1881141382166183",n="https://www.facebook.com/audiencenetwork/token/update";function o(e){var t=JSON.parse(e),r=t.fbToken,n=new Date(parseInt(t.expAfter,10)).toUTCString();document.cookie="aps_ext_917="+r+"; expires="+n}function i(r){!function(e,t,r){!function(e,t){var r={url:e,withCredentials:!0};try{r.onload=function(e){t(e.responseText)},r.onerror=function(){},(0,Tt.xhrGet)(r)}catch(e){(0,It.reportError)(e,"__error-fbTokenRequest__")}}(function(e,t){return n+"?partner="+encodeURIComponent(e)+"&vr_token="+encodeURIComponent(t)}(e,t),r)}(r,function(){for(var r="VR_",n=0;n<e;++n)r+=t.charAt(Math.floor(Math.random()*t.length));return r}(),o)}"complete"===document.readyState?i(r):window.addEventListener("load",function(){i(r)})}function q(e,t){function r(){if(!n)if(20<=o++)(0,It.reportError)({name:"LoopError",message:"Too many attempts to append to document.body"},"__error-safeDocumentBodyAppendChild-loops__",!0);else{try{if(e&&e.body&&null!==e.body&&"function"==typeof e.body.appendChild)return e.body.appendChild(t),void(n=!0)}catch(e){(0,It.reportError)(e,"__error-safeDocumentBodyAppendChild-callback__")}setTimeout(r,100)}}var n=!1,o=0;try{"complete"===e.readyState||"interactive"===e.readyState?r():e.addEventListener?e.addEventListener("DOMContentLoaded",r):e.attachEvent("onreadystatechange",function(){"complete"!==e.readyState&&"interactive"!==e.readyState||r()})}catch(e){(0,It.reportError)(e,"__error-safeDocumentBodyAppendChild-outer__")}}function F(e){var t,r;return t=""+e.host+bt.store.getState().cfg.DTB_PATH+"/imp",r=""+e.host+bt.store.getState().cfg.DTB_PATH+"/adm",e.cfe||e.isAmp?r:t}function K(e){var t,r="?b="+e.bidID+"&rnd="+(0,ht.getRand)();return(0,ht.safeObjectHasProp)(e,"pp")&&(r+="&pp="+e.pp),(0,ht.safeObjectHasProp)(e,"amznp")&&(r+="&p="+e.amznp),(0,ht.safeObjectHasProp)(e,"crID")&&(r+="&crid="+e.crID),(0,ht.safeObjectHasProp)(e,"isSharedPMP")&&!0===e.isSharedPMP&&(r+="&sp=true"),t=F(e),"1"===e.fif?t+"j"+r:t+"i"+r}function X(e){var t=e.doc.createElement("iframe");return t.frameBorder=0,t.marginHeight=0,t.marginWidth=0,t.topMargin=0,t.leftMargin=0,t.scrolling="no",t.allowTransparency=!0,t.width=e.sizes[0]+"px",t.height=e.sizes[1]+"px",t}function Q(e){var t;try{if((0,ht.safeObjectHasProp)(e,"bidType")){var r=e.kvMap;switch(e.bidType){case"sharedPMP":t={bidID:r.amzniid_sp[0],pp:r.amznbid_sp[0],sizes:r.amznsz_sp[0].split("x"),amznp:r.amznp_sp[0],isSharedPMP:e.isSharedPMP};break;case"preferredPMP":var n=e.amzndeal.split("_").pop().trim();t={bidID:r[e.amzndeal+"amzniid"][0],sizes:Ke(n)};break;case"openAuction":t=(0,ht.safeObjectHasProp)(e,"kvMap")?{bidID:r.amzniid[0],pp:(0,yt.getAmpAmznBidValue)(r.amznbid[0]),amznp:r.amznp[0],sizes:r.amznsz[0].split("x")}:{bidID:e.amzniid,pp:(0,yt.getAmpAmznBidValue)(e.amznbid),amznp:e.amznp,sizes:e.amznsz.split("x")};break;default:try{(0,It.reportError)({name:"Invalid AMP Bid Type: "+e.bidType,message:"No valid AMP bid type"},"__error-ampBidAuctionTypeSelectionDefaultBlock__")}catch(e){(0,It.reportError)(e,"__error-ampBidAuctionSwitchStatement__")}}}}catch(e){(0,It.reportError)(e,"__error-getAmpAdData__")}return t}function V(e,t){try{var r={},n={},o={};if((0,ht.safeObjectHasProp)(t,"ampEnv")&&t.ampEnv&&(r=t,(0,ht.safeObjectHasProp)(t,"bidType")&&"sharedPMP"===t.bidType?r.isSharedPMP=!0:r.isSharedPMP=!1,r.document=e),qe(e)&&((r=e).bidType="openAuction",r.ampEnv=!0),(0,ht.safeObjectHasProp)(r,"kvMap")&&(r.amznhost=t.kvMap.amznhost[0]),n=Q(r),(0,ht.safeObjectHasProp)(r,"kvMap")&&(0,ht.safeObjectHasProp)(r.kvMap,"amzncsmparams")&&r.kvMap.amzncsmparams[0]&&(o.amznCsmParams=JSON.parse(decodeURIComponent(r.kvMap.amzncsmparams[0])),Je(o)),n.doc=r.document,n.host=r.amznhost.replace("http://","https://"),n.adID="amznad"+(0,ht.getRand)(),n.isAmp=r.ampEnv,n.isSf=(0,At.isSafeFrame)(window),bt.store.getState().amznCsmParams.ev)return void Ve(n,n.doc);J(n)}catch(e){(0,It.reportError)(e,"__error-renderAmpImpression__")}}function Y(e){try{var t=X(e=mt({hasRendered:!1,hasStartedRender:!1},e));t.id="apstag-f-iframe-"+(0,ht.getRand)(),t.setAttribute("srcdoc",e.html),t.src='javascript: window.frameElement.getAttribute("srcdoc");',q(e.doc,t)}catch(e){(0,It.reportError)(e,"__error-loadAdIntoFriendlyIframe__",!0)}}function J(e,t){try{var r=X(e),n={};if(r.id=e.adID,r.sandbox="allow-forms allow-pointer-lock allow-popups allow-popups-to-escape-sandbox allow-same-origin allow-scripts allow-top-navigation-by-user-activation",(0,vt.isDebugEnabled)("fake_bids")){var o='<body style="background-color: #FF9900;">'+(50<e.sizes[1]?"<h3>apstag Test Creative</h3>":"")+"<h4>amzniid - "+e.bidID+" | amznbid: "+e.pp+" | size: "+e.sizes.join("x")+"</h4></body>";r.src="javascript:'"+o+"'"}else r.src=K(e);e.isAmp?(n.doc=e.doc,n.amzniid=e.bidID,n.slotID="amp",e.isSf&&(0,At.is1x1Creative)(window)&&(0,At.expandSf)(e.sizes,window)):(n=j(e.bidID,e.isSharedPMP).slotBid).doc=e.doc,q(e.doc,r),e.viewabilityParams=e.viewabilityParams||{states:{}},(e.viewabilityParams.iframe=r).onload=function(){e.viewabilityParams.states.iframeLoaded=!0,t&&t()}}catch(e){(0,It.reportError)(e,"__error-loadAdIntoUnfriendlyIframe__",!0)}}function W(e,t){var r,n=e.states,o=e.doc,i=e.bidID,a=e.iframe;Me(n)||(n.shouldRunViewability=!1,(0,ht.safeObjectHasProp)(window,"amzncsm")?r=window.amzncsm:(0,ht.safeObjectHasProp)(o.defaultView,"amzncsm")&&(r=o.defaultView.amzncsm),r&&(0,ht.safeObjectHasProp)(r,"rmD")&&(r.host=(0,vt.getDebugValue)("host",bt.store.getState().hosts.DEFAULT_AAX_PIXEL_HOST),r.rmD(a,i,o.defaultView,o,null,t)))}function $(e){var t=e.map(se),r={};return Object.keys(bt.store.getState().slotBids).forEach(function(e){var n=bt.store.getState().slotBids[e].filter(function(e){return e.bidState===Et.BID_STATES.new})[0];n&&(0,ht.inArray)(t,e)&&(r[e]=n,bt.store.dispatch({type:"BID_STATE_CHANGE",slotID:e,_targetingSetID:n._targetingSetID,bidState:Et.BID_STATES.exposed}))}),r}function Z(e,t){var r="0x0";return D()?{slotID:e,size:r,mediaType:"banner",targeting:{amznbid:t,amzniid:"",amznp:t,amznsz:r},helpers:{targetingKeys:["amznbid","amzniid","amznp","amznsz"]}}:{slotID:e,amzniid:"",amznbid:t,amznp:t,amznsz:r,size:r}}function ee(e,t){var r="";return e.targeting.forEach(function(t){r+="&"+t+"="+e[t]}),!0===t&&(r=encodeURIComponent(r)),r}function te(e,t,r){var n,o=t.slots.filter(Ue).map(se),i=e.map(se);return n=r?o.map(function(e){return Z(e,Et.SLOT_STATES.bidInFlight)}):o.reduce(function(e,t){return(0,ht.inArray)(i,t)||e.push(Z(t,Et.SLOT_STATES.noBid)),e},[]),e.concat(n)}function re(e,t){return function(r){var n=$(t.slots),o=Object.keys(n),i=[];r&&(bt.store.dispatch({type:"RECORD_AAX_RESPONSE_PROP",bidReqID:t.bidReqID,key:"timedOutAt",value:Date.now()}),bt.store.getState().experiments.chunkRequests&&bt.store.dispatch({type:"RECORD_TIMEOUT",fid:t.bidReqID,timeOut:Date.now()})),o.forEach(function(e){if((0,ht.safeObjectHasProp)(n,e)){var t=n[e],r={};if(D())t.meta.forEach(function(e){r[e]=t[e]}),r.targeting={},t.targeting.forEach(function(e){r.targeting[e]=t[e]}),r.helpers={targetingKeys:t.targeting,qsParams:ee.bind(null,t,!1),encodedQsParams:ee.bind(null,t,!0)};else if((0,ht.safeObjectHasProp)(t,"amznbid")){if((0,ht.safeObjectHasProp)(t,"amznp")||(t.amznp=""),r={amzniid:t.amzniid,amznbid:t.amznbid,amznp:t.amznp,slotID:e},(0,ht.safeObjectHasProp)(t,"size")&&(r.size=t.size,r.amznsz=t.amznsz),"video"===t.mediaType){r.mediaType="video";var o="";t.amznbid?o+="&amzniid="+t.amzniid+"&amznbid="+t.amznbid+"&amznp="+t.amznp:(r.amznbid="",r.amzniid=""),t.r_amznbid?(r.r_amznbid=t.r_amznbid,r.r_amzniid=t.r_amzniid,r.r_amznp=t.r_amznp,o+="&r_amzniid="+t.r_amzniid+"&r_amznbid="+t.r_amznbid+"&r_amznp="+t.r_amznp):(r.r_amznbid="",r.r_amzniid="",r.r_amznp=""),r.qsParams=o,r.encodedQsParams=encodeURIComponent(o)}}else r=Z(t.slotID,Et.SLOT_STATES.noBid);i.push(r)}}),wt.displayAdServer.isSupported&&(i=te(i,t,r)),wt.displayAdServer.appendTargeting(i),e(i,{fromTimeout:r})}}function ne(e,t){try{var r;(r=e.defaultView&&e.defaultView.frameElement?e.defaultView.frameElement:window.frameElement).width=t[0],r.height=t[1]}catch(e){(0,It.reportError)(e,"__error-resizeIframe__")}}function oe(e){return e[0]+"x"+e[1]}function ie(e){return 1===e.length?oe(e[0]):oe(e[Math.floor(e.length*Math.random())])}function ae(e,t){var r,n=(0,vt.getDebugValue)("host",bt.store.getState().hosts.DEFAULT_AAX_BID_HOST),o=(0,yt.getCurrentUrl)(window),i=e.bidReqID,a=(0,ht.getWindowDimensions)(window),s=(0,vt.getDebugValue)("testBidTimeout",200);bt.store.dispatch({type:"RECORD_AAX_REQUEST",data:{bidConfig:e,timeout:s,bidReqID:i,ws:a,url:o,rqTs:Date.now()}}),r=e.slots.map(function(e){var t={slotID:e.slotID,amzniid:Et.MOCKBID.amzniid+"-"+(0,ht.getRand)(),amznbid:Et.MOCKBID.amznbid,amznp:Et.MOCKBID.amznp,crid:Et.MOCKBID.crid+"-"+(0,ht.getRand)()};if((0,ht.safeObjectHasProp)(e,"sizes")){var r=ie(e.sizes);t.size=r,t.amznsz=r}else"video"===e.mediaType&&(t.mediaType="video",t.amznbid="v_"+t.amznbid);if(D()){t.mediaType="banner",t.meta=["slotID","mediaType","size"],t.amznbid_sp=Et.MOCKBID.amznbid+"SP",t.amznp_sp=Et.MOCKBID.amznp+"SP",t.amznsz_sp=t.size;var n="testDeal"+(0,ht.getRand)()+"_"+t.size,o="testDealImpression-"+(0,ht.getRand)();t.amzndeal_sp=n,t.amzndeals=[n],t[n+"amzniid"]=o,t.amzniid_sp=o,t.targeting=["amzniid","amznbid","amznp","amznsz","amzniid_sp","amznbid_sp","amznp_sp","amznsz_sp","amzndeal_sp","amzndeals",n+"amzniid"]}return t}),setTimeout(function(){window.apstag.bids({slots:r,host:n,status:"ok",cb:i}),t(!0)},s)}function se(e){return e.slotID}function ce(e){var t=bt.store.getState().AAXReqs.filter(function(t){return t.bidReqID===e.cb})[0];if(t&&t.bidConfig&&t.bidConfig.slots){var r=t.bidConfig.slots.filter(Ue).map(function(e){return e.slotID}),n=(0,ht.safeObjectHasProp)(e,"slots")?e.slots.map(function(e){return e.slotID}):[],o=r.filter(function(e){return!(0,ht.inArray)(n,e)});bt.store.dispatch({type:"NO_BID_ON_ADSERVER_SLOTS",slotIDs:o}),wt.displayAdServer.hasAdServerObjectLoaded()?le():wt.displayAdServer.isCommandQueueDefined()&&wt.displayAdServer.cmdQueuePush(function(){le()})}}function ue(e){return(0,ht.inArray)(bt.store.getState().AAXReqs.filter(function(e){return!e.resTs}).map(function(e){return e.bidConfig.slots}).reduce(function(e,t){return e.concat(t)},[]).map(se),e)}function de(e){var t=wt.displayAdServer.getTargeting("amznbid",e);return 0<t.length&&2<t[0].length}function le(){wt.displayAdServer.hasAdServerObjectLoaded()&&"1"===wt.displayAdServer.getTargeting("amznbid")[0]&&pe(),(0,yt.getDisplayAdServerSlots)(wt.displayAdServer).forEach(function(e){!(0,ht.inArray)(bt.store.getState().displayAdServer.noBidSlotIDs,wt.displayAdServer.getSlotElementId(e))||ue(wt.displayAdServer.getSlotElementId(e))||de(e)||"2"===wt.displayAdServer.getTargeting("amznbid",e)[0]||fe("noBid",e)})}function fe(e,t){Et.SLOT_STATE_KEYS.forEach(function(r){return wt.displayAdServer.setTargeting(r,Et.SLOT_STATES[e],t)})}function pe(){Et.SLOT_STATE_KEYS.forEach(function(e){return wt.displayAdServer.clearTargeting(e)})}function ge(e){var t={_type:"dupePixel",dd:Date.now()-e.renderTime};(0,Dt.bidCacheIdPixel)(e.amzniid,t)}function me(){var e=(0,Ot.getResourcePerformanceObject)(window,"aax2/apstag.js"),t={pid:a,ns:n,fs:(0,Ot.getMetricFromPerformanceObject)(e,"fetchStart"),re:(0,Ot.getMetricFromPerformanceObject)(e,"responseEnd")},r=(0,Ot.isResourceCached)(e);null!==r&&(t.c=r?1:0),setTimeout(Dt.noBidCacheIdPixel,1e3,t)}var _e=0,Se;function be(){(0,ht.safeObjectHasProp)(window,"googletag")&&(0,ht.safeObjectHasProp)(window.googletag,"cmd")?Pt.displayAdServerGoogletag.cmdQueuePush(function(){window.googletag.pubads().addEventListener("slotRequested",function(e){try{var t=e.slot;bt.store.dispatch({type:"LOG_GAM_EVENT",event:mt({},rt(t),{ts:Date.now(),targeting:t.getTargetingMap()})})}catch(e){(0,It.reportError)(e,"__error-latency-parse-event__")}})}):++_e<5&&setTimeout(be,100)}function ye(e){var t=e.AAXReqs.slice(e.gamSlotRenderPixel.aaxReqOffset).reduce(function(e,t){return e.concat(t.bidConfig.slots)},[]).map(function(e){return mt({},e,{type:"a"})}).filter(function(e){return"video"!==e.mediaType}),r=e.gamSlotFetchLog.slice(e.gamSlotRenderPixel.gamSlotFetchLogOffset).map(function(e){return mt({},e,{type:"g"})}),n=[].concat(t).concat(r).reduce(function(e,t){return(0,ht.safeObjectHasProp)(e,t.slotID)||(e[t.slotID]={sd:t.slotID,a:{c:0},g:{c:0}}),e[t.slotID][t.type].c++,e[t.slotID][t.type].s=t.sizes,e[t.slotID][t.type].sn=t.slotName||"",e},{});return Object.keys(n).map(function(e){return n[e]}).filter(function(e){return 0!==e.a.c||0!==e.g.c})}function he(){var e=bt.store.getState(),t=ye(e);0<Object.keys(t).length&&((0,ht.chunkArray)(t,5).forEach(function(t){(0,Dt.noBidCacheIdPixel)({slots:t,pid:a,url:(0,yt.getCurrentUrl)(window).split("?")[0],ws:(0,ht.getWindowDimensions)(window),pubid:e.config.pubID,_type:"slotRenders"})}),bt.store.dispatch({type:"UPDATE_RENDER_OFFSETS",offsets:{aaxReqOffset:e.AAXReqs.length,gamSlotFetchLogOffset:e.gamSlotFetchLog.length}}))}function ve(){setInterval(function(){he()},5e3)}function Ee(){try{setTimeout(function(){var e=Ie().filter(function(e){return!(0,ht.safeObjectHasProp)(bt.store.getState().bsPixels,e.iid)||e.state!==bt.store.getState().bsPixels[e.iid]});e&&e.length&&0<e.length&&(e.forEach(function(e){var t=e.iid,r=Lt(e,["iid"]);(0,Dt.bidCacheIdPixel)(t,Ae(r))}),Oe(e));var t={fetchStart:"a",domainLookupStart:"b",domainLookupEnd:"c",connectStart:"d",secureConnectionStart:"e",connectEnd:"f",requestStart:"g",responseStart:"h",responseEnd:"i",resTs:"j"};Object.keys(bt.store.getState().slotBids).forEach(function(e){bt.store.getState().slotBids[e].filter(function(e){return void 0!==e.amzniid}).forEach(function(r){if(!r.pixelSent){var n=bt.store.getState().AAXReqs.filter(function(e){return e.bidReqID===r.bidReqID})[0];if("object"===(void 0===n?"undefined":gt(n))&&null!==n){var o=n.rqTs-(0,Ot.getTimeOrigin)(),i={pid:a,lv:Et.LIBRARY_VERSION,ns:n.bidConfig.slots.length,fid:r.bidReqID,fbrq:n.rqTs,_type:"latencyBd"};"object"===gt(n.perf)&&null!==n.perf&&Object.keys(t).forEach(function(e){0!==(0,Ot.getMetricFromPerformanceObject)(n.perf,e)&&(i[t[e]]=(0,Ot.getMetricFromPerformanceObject)(n.perf,e)-o)}),i[t.resTs]=n.resTs-n.rqTs,(0,Dt.bidCacheIdPixel)(r.amzniid,i),bt.store.dispatch({type:"UPDATE_BID_INFO_PROP",slotID:e,iid:r.amzniid,key:"pixelSent",value:!0})}}})}),Ee()},5e3)}catch(e){(0,It.reportError)(e,"__error-bidSetPixel__")}}function Oe(e){e.forEach(function(e){return bt.store.dispatch({type:"RECORD_BID_INFO_SENT",bidInfo:e})})}function Ae(e){var t={};try{var r=De(e.fid);(t={status:e.state,pubid:bt.store.getState().config.pubID,lv:Et.LIBRARY_VERSION,_type:"bidSetPixel"}).toa=(0,ht.safeObjectHasProp)(r.req,"timedOutAt")?r.req.timedOutAt:"0",t.fbrq=r.req.rqTs,t.pto=r.req.timeout,t.ns=r.req.bidConfig.slots.length,t.bla=r.req.resTs-r.req.rqTs,t.reqindex=r.index,t.fid=e.fid,bt.store.getState().cfg.CHUNK_BID_REQUESTS_PROPORTION&&(t.eid=bt.store.getState().experiments.chunkRequests?2:1,t.fbindex=r.fbIndex,t.fbns=bt.store.getState().bidConfigs[e.fid.split("-")[0]].slots.length),e.delta&&(t.delay=e.delta);try{var n=r.req.perf;void 0!==n&&(t.ul=(0,Ot.getURLLengthFromPerformanceObject)(n),t.es=(0,Ot.getMetricFromPerformanceObject)(n,"encodedBodySize"))}catch(e){(0,It.reportError)(e,"__error-mapBidInfoToPixel-size__")}}catch(e){(0,It.reportError)(e,"__error-mapBidInfoToPixel__")}return t}function De(e){var t={req:bt.store.getState().AAXReqs.filter(function(t){return t.bidReqID===e})[0]};return t.index=bt.store.getState().AAXReqs.indexOf(t.req)+1,bt.store.getState().experiments.chunkRequests?t.fbIndex=bt.store.getState().AAXReqs.filter(function(e){return-1===e.bidReqID.indexOf("-")||"0"===e.bidReqID.split("-")[1]}).map(function(e){return e.bidReqID.split("-")[0]}).indexOf(e.split("-")[0])+1:t.fbIndex=t.index,t}function Ie(){var e=we(),t=[];return e&&Object.keys(bt.store.getState().slotBids).forEach(function(r){"video"!==bt.store.getState().slotBids[r][0].mediaType&&bt.store.getState().slotBids[r].filter(function(e){return void 0!==e.amzniid}).forEach(function(n){var o={slotID:r,iid:n.amzniid,fid:n.bidReqID},i=[],a=[];if(r in e&&(i=e[r].fetchedAt.filter(function(e){return e.AAXReqInfo&&e.AAXReqInfo.bidReqID===n.bidReqID}),a=e[r].targetedAt.filter(function(e){return e.targeting===n.amzniid})),0<i.length?0<i.length&&a.length>=i.length&&i.slice(i.length-1)[0].ts>a.slice(i.length-1)[0].ts?1===e[r].fetchWithIID.filter(function(e){return e===n.amzniid}).length?o.state=1:o.state=4:-1!==e[r].fetchWithIID.indexOf(n.amzniid)?o.state=3:o.state=2:o.state=0,1===o.state||2===o.state){var s=bt.store.getState().AAXReqs.filter(function(e){return e.bidReqID===n.bidReqID})[0].resTs,c=Te(s,e[r].fetchedAt,2===o.state);c&&(0,ht.safeObjectHasProp)(c,"ts")&&(o.delta=s-c.ts)}t.push(o)})}),t}function Te(e,t,r){var n=t.map(function(t){var n=e-t.ts;return r?0<=n?n:null:n<=0?-n:null});return t[Pe(n)]}function Pe(e){for(var t,r,n,o=0;o<e.length;o++)"number"==typeof(t=e[o])&&("number"!=typeof n||t<r)&&(n=o,r=t);return n}function Re(e,t){return bt.store.getState().AAXReqs.filter(function(e){return-1<e.bidConfig.slots.map(function(e){return e.slotID}).indexOf(t)})[e]}function we(){if(!wt.displayAdServer.hasAdServerObjectLoaded())return null;var e=bt.store.getState().gamSlotFetchLog.reduce(function(e,t){(0,ht.safeObjectHasProp)(e,t.slotID)||(e[t.slotID]={fetchedAt:[],targetedAt:[]});var r=e[t.slotID];return r.fetchedAt.push({ts:t.ts,AAXReqInfo:Re(r.fetchedAt.length,t.slotID)}),(0,ht.safeObjectHasProp)(t.targeting,"amzniid")&&(0,ht.safeObjectHasProp)(t.targeting.amzniid,0)?r.targetedAt.push({ts:t.ts-1,targeting:t.targeting.amzniid[0]}):r.targetedAt.push({ts:t.ts-1,targeting:""}),e},{});return Object.keys(e).forEach(function(t){var r=e[t];r.fetchWithIID=r.fetchedAt.map(function(e){var t=Te(e.ts,r.targetedAt,!0);return t?t.targeting:0}),e[t]=r}),e}function Ce(){ze(),Le()}function ze(){"http://"===Et.PROTOCOL&&new _t.default({run:je.bind(null,["http","https"]),cases:{aax:["http://aax.amazon-adsystem.com/dtb-ping","https://aax.amazon-adsystem.com/dtb-ping"],cf:["http://c.amazon-adsystem.com/aax2/dtb-ping.txt","https://c.amazon-adsystem.com/aax2/dtb-ping.txt"]},name:"https",sample:"EXPERIMENT_HTTPS"})}function Le(){new _t.default({run:je.bind(null,["aax","cf"]),cases:{tst:[Et.PROTOCOL+"aax.amazon-adsystem.com/dtb-ping",Et.PROTOCOL+"c.amazon-adsystem.com/dtb-ping"]},name:"edge-server",pixelTemplate:{env:Et.PROTOCOL.replace(/[\W]/g,"")},sample:"EXPERIMENT_EDGE"})}function je(e,t,r){r=Be(r),Ne((0,ht.shuffleArray)(r),function(){var n;return t((zt(n={pubID:bt.store.getState().config?bt.store.getState().config.pubID:null},e[0],xe(r[0])),zt(n,e[1],xe(r[1])),n))})}function Be(e){return e.map(function(e){return e+(-1===e.indexOf("?")?"?":"&")+"cb="+(0,ht.getRand)()})}function xe(e){try{var t=(0,Ot.getResourcePerformanceObject)(window,e);return(0,Ot.getMetricFromPerformanceObject)(t,"responseEnd")-(0,Ot.getMetricFromPerformanceObject)(t,"fetchStart")}catch(e){return(0,It.reportError)(e,"__getRoundTripTime-error__"),0}}function Ne(e,t){var r={requests:{},callback:!1};function n(e){r.requests[e]=!0,!r.callback&&Me(r.requests)&&t()}e.map(function(e){r.requests[e]=!1}),e.map(function(e){(0,Tt.xhrGet)({url:e,onload:n.bind(null,e),onerror:n.bind(null,e,!0)})})}function Me(e){var t=Object.keys(e);return t.map(function(t){return e[t]}).filter(function(e){return e}).length===t.length}function He(){wt.displayAdServer.hasAdServerObjectLoaded()?fe("noRequest"):wt.displayAdServer.isCommandQueueDefined()&&wt.displayAdServer.cmdQueuePush(function(){fe("noRequest")})}function Ue(e){return"video"!==e.mediaType}function Ge(e){wt.displayAdServer.isCommandQueueDefined()&&(bt.store.dispatch({type:"REQUESTED_BID_FOR_ADSERVER_SLOTS",slotIDs:e}),bt.store.dispatch({type:"REQUESTED_BID_FOR_PMP_ONLY_DFP_SLOTS",slotIDs:e}),wt.displayAdServer.cmdQueuePush(function(){var t=(0,yt.getDisplayAdServerSlots)(wt.displayAdServer);"0"===wt.displayAdServer.getTargeting("amznbid")[0]&&pe(),C(e,t.map(function(e){return wt.displayAdServer.getSlotElementId(e)}))?t.forEach(function(t){(0,ht.inArray)(e,wt.displayAdServer.getSlotElementId(t))&&!de(t)&&fe("bidInFlight",t)}):wt.displayAdServer.cmdQueuePush(function(){fe("bidInFlight")})}))}function ke(){return window.AMP_CONTEXT_DATA&&"AMP-AD"===window.AMP_CONTEXT_DATA.tagName}function qe(e){return(0,ht.safeObjectHasProp)(e,"type")&&"amp"===e.type&&!(e instanceof Document)}function Fe(e,t){return(0,ht.safeObjectHasProp)(t,"ampEnv")&&t.ampEnv||qe(e)}function Ke(e){return e.split("x").map(function(e){return parseInt(e,10)})}function Xe(e,t,r){try{(0,Dt.sendPixels)()}catch(e){(0,It.reportError)(e,"__sendPixels-renderImp__")}if(Fe(e,r)&&ke())V(e,r);else{var n=!1;t&&"string"==typeof t&&0===t.indexOf("sp|")&&(t=t.substring(3),n=!0);var o,i=t||e.amzniid,a=j(i,n),s=a.slotBid,c=a.dealId;if(o=c&&1<=c.length?Ke("sp"===c?s.amznsz_sp:B(i,s,c)):Ke(s.size),1!==arguments.length)if(s){s.bidState===Et.BID_STATES.rendered&&ge(s),bt.store.dispatch({type:"BID_STATE_CHANGE",slotID:s.slotID,_targetingSetID:s._targetingSetID,bidState:Et.BID_STATES.rendered,dealId:c,ts:Date.now()}),f.addTimer("imp");var u=s.host,d="amznad"+Math.round(1e6*Math.random()),l={bidID:t,doc:e,pp:Qe("amznbid",s,c),host:u,adID:d,sizes:o,amznp:Qe("amznp",s,c),crID:Qe("crid",s,c),fif:!1,dealId:c,isSharedPMP:n,cfe:s.cfe};"1"===s.fif?(l.fif="1",bt.store.dispatch({type:"UPDATE_BID_INFO_PROP",slotID:s.slotID,iid:t,key:"doc",value:e,dealId:c}),(0,Tt.loadScriptTag)(K(l),null,document)):bt.store.getState().amznCsmParams.ev?Ve(l,e):J(l),ne(e,o)}else(0,It.reportError)(new Error("Invalid bid ID tried to render"),"__error-invalid_bid_id_render__");else Y({doc:s.doc,bidID:s.amzniid,sizes:o,html:e.html})}}function Qe(e,t,r){return r&&1<=r.length?"sp"===r?t[e+"_sp"]:"":t[e]?t[e]:""}function Ve(e,t){var r=t.createElement("script");r.type="text/javascript",r.async=!0,e.viewabilityParams={doc:t,bidID:e.bidID,states:{csmLoaded:!1,iframeLoaded:!1,shouldRunViewability:!0}},e.amznCsmParams=bt.store.getState().amznCsmParams;var n=W.bind(null,e.viewabilityParams,e.amznCsmParams);(0,Tt.addOnLoadFunction)(r,function(){e.viewabilityParams.states.csmLoaded=!0,n()});try{r.onerror=function(e){return(0,Dt.noBidCacheIdPixel)({_type:"csm_fail",ts:Date.now(),msg:e.message})}}catch(e){(0,It.reportError)(e,"__error-csm_onerror__")}J(e,n),r.src=e.amznCsmParams.cfn,q(t,r)}function Ye(e){return"//"===e.substring(0,2)?e:"//c.amazon-adsystem.com/"+e}function Je(e){try{var t={ev:!1,cfn:bt.store.getState().cfg.CSM_JS};(0,ht.safeObjectHasProp)(e,"ev")&&(t.ev=e.ev),(0,ht.safeObjectHasProp)(e,"cfn")&&(t.cfn=Ye(e.cfn)),(0,ht.safeObjectHasProp)(e,"amznCsmParams")&&(t=e.amznCsmParams,(0,ht.safeObjectHasProp)(e.amznCsmParams,"cfn")&&(t.cfn=Ye(e.amznCsmParams.cfn))),bt.store.dispatch({type:"SET_AMZNCSMPARAMS",amznCsmParams:t})}catch(e){(0,It.reportError)(e,"__setCsmState__")}}function We(e){y(e),(0,ht.safeObjectHasProp)(e,"slots")&&(bt.store.dispatch({type:"UPDATE_SLOT_BIDS",bids:N(e)}),Je(e)),h(e)}function $e(){return"number"==typeof bt.store.getState().cfg.MAX_SLOTS_PER_REQUEST&&0<bt.store.getState().cfg.MAX_SLOTS_PER_REQUEST}function Ze(e,t){var r=it.bind(null,e,t);void 0===bt.store.getState().gdpr||null===bt.store.getState().gdpr?(bt.store.dispatch({type:"ADD_GDPR_QUE_ITEM",func:r}),1===bt.store.getState().gdprQue.length&&(0,St.GDPR)(bt.store.getState().config.gdpr,et)):r()}function et(e){bt.store.dispatch({type:"SET_GDPR_CONFIG",config:e}),bt.store.getState().gdprQue.map(function(e){try{e()}catch(e){(0,It.reportError)(e,"__gdpr_que__")}}),bt.store.dispatch({type:"CLEAR_GDPR_QUE"})}function tt(e){var t=[];try{t=e.filter(function(e){return"fluid"!==e}).map(function(e){return[e.getWidth(),e.getHeight()]})}catch(e){}return t}function rt(e){var t=(0,ht.getWindowDimensions)(window).split("x");return{slotID:e.getSlotElementId(),slotName:e.getAdUnitPath(),sizes:tt(e.getSizes(Number(t[0]),Number(t[1])))}}function nt(e){return e.filter(function(e){return 0!==e.sizes.length})}function ot(e){return nt((e=e||(0,yt.getDisplayAdServerSlots)(wt.displayAdServer)).map(function(e){return rt(e)}))}function it(e,t){var r=!1;!0===bt.store.getState().config.simplerGPT&&(!(0,ht.safeObjectHasProp)(e,"slots")||0<e.slots.length&&!(0,ht.safeObjectHasProp)(e.slots[0],"slotID"))&&(0===(0,yt.getDisplayAdServerSlots)(wt.displayAdServer).length?((0,It.reportError)(new Error("fetchBids was called in simplerGPT mode before any slots were defined in GPT"),!0),r=!0,e.slots=[]):(e.slots=ot(e.slots),0===e.slots.length&&((0,It.consoleWarn)(new Error("No GPT slots provided to apstag.fetchBids() had valid sizes"),!0),r=!0)));var n,o,i=st(e.slots);i&&(e.slots=i);try{n=(n=l(n=e.timeout||bt.store.getState().config.bidTimeout||bt.store.getState().cfg.DEFAULT_TIMEOUT))||bt.store.getState().cfg.DEFAULT_TIMEOUT,"function"!=typeof t&&(void 0!==t&&(0,It.reportError)(new Error("Invalid callback function provided to apstag.fetchBids"),"__error-invalid_callback_fetchbids_",!0),t=function(){}),e.bidReqID=""+bt.store.getState().AAXReqs.length,t=E(re(t,e),n)}catch(e){(0,It.reportError)(e,"__error-fetchBids__",!0)}if(0===e.slots.length)return!1===r&&(0,It.reportError)(new Error("No slots provided to apstag.fetchBids"),"__error-no_slots_provided_bid_request__",!0),void setTimeout(t.bind(null,[]),10);if(Ge(e.slots.filter(Ue).map(se)),bt.store.dispatch({type:"NEW_FETCH_BID_REQUEST",fid:e.bidReqID,pto:n}),bt.store.dispatch({type:"RECORD_ORIGINAL_BID_CONFIG",bidConfig:e}),(0,vt.isDebugEnabled)("fake_bids"))ae(e,t);else if(Et.HAS_XHR_SUPPORT)if(bt.store.dispatch({type:"SHOULD_CHUNK_REQUESTS",value:(0,ht.shouldSample)(bt.store.getState().cfg.CHUNK_BID_REQUESTS_PROPORTION)}),bt.store.getState().experiments.chunkRequests&&$e()){o=at(e);for(var a=0;a<o.length;a++)o[a].bidReqID=e.bidReqID+"-"+a;bt.store.dispatch({type:"ADD_CHUNKED_REQUESTS",fid:e.bidReqID,numChunks:o.length}),o.forEach(function(e){_((0,Ct.buildBidUrl)(e,n),t,e.bidReqID)})}else _((0,Ct.buildBidUrl)(e,n),t,e.bidReqID);else(0,Tt.loadScriptTag)((0,Ct.buildBidUrl)(e,n),t)}function at(e){for(var t=Math.ceil(e.slots.length/bt.store.getState().cfg.MAX_SLOTS_PER_REQUEST),r=new Array(t),n=0;n<t;n++){var o=n*bt.store.getState().cfg.MAX_SLOTS_PER_REQUEST;r[n]={slots:e.slots.slice(o,o+bt.store.getState().cfg.MAX_SLOTS_PER_REQUEST)}}return r.map(function(t){return mt({},e,t)})}function st(e){try{return e.map(function(e){return e.sizes&&(0,ht.isArray)(e.sizes)&&!(0,ht.isArray)(e.sizes[0])?mt({},e,{sizes:[e.sizes]}):e})}catch(e){(0,It.reportError)(e,"__error-adjustSlotArraySizes__",!0)}return!1}function ct(e){(0,ht.safeObjectHasProp)(bt.store.getState().config,"adServer")?wt.displayAdServer.isSupported?(G(e),le()):(0,It.reportError)(new Error("apstag.setDisplayBids called with unsupported ad server: "+bt.store.getState().config.adServer),"__error-invalid_ad_server_setdisplaybids__",!0):(0,It.reportError)(new Error("apstag.setDisplayBids called without specifying ad server"),"__error-no_ad_server_setdisplaybids__",!0)}function ut(e,t){(0,wt.setDisplayAdServer)(e.adServer);var r=A(e);He(),"success"===r&&"function"==typeof t&&t()}function dt(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"display";switch(e){case"display":return Et.DISPLAY_TARGETING_KEYS;case"video":return Et.VIDEO_TARGETING_KEYS;default:return D()&&(0,ht.isArray)(bt.store.getState().targetingKeys[e])?bt.store.getState().targetingKeys[e]:"unknown targeting type "+e}}function lt(){return bt.store.getState().AAXReqs.reduce(function(e,t){return t.bidConfig.slots.reduce(function(e,t){return e[t.slotID]=t.slotName,e},e)},{})}function ft(e,t){var r=t;return function(){return c({method:e,args:arguments}),r.apply(void 0,arguments)}}function pt(e,t){return function(){try{return e.apply(void 0,arguments)}catch(e){return(0,It.reportError)(e,t,!0),null}}}f.addTimer("tlt");try{(0,ht.safeObjectHasProp)(window,"apstag")&&(0,ht.safeObjectHasProp)(window.apstag,"_Q")&&0<window.apstag._Q.length&&bt.store.dispatch({type:"SET_Q",Q:window.apstag._Q})}catch(e){(0,It.reportError)(e,"__error-storeApstagQ__")}window.apstag=(Se={punt:We,init:ut,debug:vt.debugPublicApi,_getSlotIdToNameMapping:lt,targetingKeys:dt,fetchBids:Ze,setDisplayBids:ct,renderImp:Xe,bids:We},Object.keys(Se).forEach(function(e){Se[e]=ft(e,Se[e])}),r?(0,vt.enableDebugConsole)(!0,e):t&&(0,vt.enableDebugConsole)(!1,e),Object.keys(Se).forEach(function(e){Se[e]=pt(Se[e],e)}),!0===(0,vt.getDebugValue)("exposeApi")&&(Se._api={_getBidSetInfo:Ie,_applyTargetingToGPTSlot:M,dispatch:bt.store.dispatch,_clearTargetingFromGPTSlot:P,_clearbidSetOnSlot:R,_doFbSync:k,_getCurrentSlotBids:z,_creativeURL:K,getSlotFetchCounts:ye}),Se),function(){try{Rt.IS_RENDER_BIDDING_PAGELOAD&&(0,Rt.setRenderBiddingHosts)(),bt.store.dispatch({type:"SHOULD_CF_ROUTE",value:(0,ht.shouldSample)(bt.store.getState().cfg.CF_ROUTING_RATE)}),bt.store.getState().experiments.shouldCFRoute&&!Rt.IS_RENDER_BIDDING_PAGELOAD&&bt.store.dispatch({type:"SET_HOST",hostName:"DEFAULT_AAX_BID_HOST",hostValue:"c.amazon-adsystem.com"}),bt.store.dispatch({type:"SHOULD_SAMPLE_LATENCY",value:(0,ht.shouldSample)(bt.store.getState().cfg.LATENCY_SAMPLING_RATE)}),bt.store.dispatch({type:"SHOULD_SAMPLE_SLOT_RENDER",value:(0,ht.shouldSample)(bt.store.getState().cfg.SLOT_RENDER_SAMPLING_RATE)});var e=bt.store.getState();(e.experiments.shouldSampleLatency||e.displayAdServer.shouldSampleRender)&&be(),e.displayAdServer.shouldSampleRender&&ve(),e.experiments.shouldSampleLatency&&(me(),Ee()),Ce()}catch(e){(0,It.reportError)(e,"__error-sampleLatency__")}try{O()}catch(e){(0,It.reportError)(e,"__error-doLast__")}if(!ke())try{var t={};t.url=bt.store.getState().cfg.CSM_RTB_COMMUNICATOR_JS;var r=function(e){e&&"object"!==(void 0===e?"undefined":gt(e))||(e="Request Timeout or Error"),(0,It.reportError)({message:"csm-rtb-comm-js loading failed",name:e},"__csm-rtb-comm-js__")};t.onload=function(e){e.readyState===XMLHttpRequest.DONE&&200===e.status?eval(e.responseText):r(JSON.stringify({status:e.statusText,response:e.responseXML}))},t.onerror=r,t.ontimeout=r,(0,Tt.xhrGet)(t)}catch(e){(0,It.reportError)(e,"__load-csm-rtb-comm-js__")}(0,vt.pixelDebugModes)()}()}())}catch(e){(0,It.reportError)(e,"__error-global__")}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e};t.default=function(e){var t=this,r=e.run,s=e.cases,c=e.name,u=e.sample,d=void 0===u?1:u,l=e.delay,f=void 0===l?5e3:l,p=e.pixelTemplate,g=void 0===p?{}:p;this.testId=(0,i.getRand)();var m=function(e){_("pixeling"),(e=n({},g,e))._type=encodeURIComponent(c+"-tst"),1<Object.keys(s).length&&(e._case=encodeURIComponent(t.runningCase)),(0,a.noBidCacheIdPixel)(e),_("done")},_=function(e){t.status=e,o.store.dispatch({type:"UPDATE_TEST",id:t.testId,status:t.status,name:t.name,case:t.runningCase})};this.name=c,this.sampleRate=d,this.runningCase="",this.status="",_("config"),_("waiting"),setTimeout(function(){"string"==typeof d&&(d=o.store.getState().cfg[d]),(0,i.shouldSample)(d)?(_("setup"),t.runningCase=(0,i.getRandomArrayElement)(Object.keys(s)),_("running"),r(m,s[t.runningCase])):_("nosample")},f)};var o=r(2),i=r(0),a=r(5)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isSafeFrame=function(e){return!(!(0,o.safeObjectHasProp)(e,"$sf")||!(0,o.safeObjectHasProp)(e.$sf,"ext"))},t.expandSf=function(e,t){try{var r=t.innerWidth,o=t.innerHeight,i=parseInt(e[0],10),a=parseInt(e[1],10),s=i-r,c=a-o,u=t.sfAPI||t.$sf.ext;u&&(r===i&&o===a||(u.register(i,a),u.expand({r:s,b:c,push:!0})))}catch(e){(0,n.reportError)(e,"__error-expandSF__")}},t.is1x1Creative=function(e){return 1===e.innerWidth&&1===e.innerHeight};var n=r(3),o=r(0)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isApstagLibrary=function(e){return void 0!==e&&!!(0,o.isObject)(e)&&(0,o.safeObjectHasProp)(e,"debug")},t.hasApstagJsLoaded=function(e){return!!(0,o.safeObjectHasProp)(e,n.APSTAG_LOADED_VARIABLE)&&!0===e[n.APSTAG_LOADED_VARIABLE]};var n=r(1),o=r(0)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.displayAdServer=void 0,t.setDisplayAdServer=function(e){switch(e){case"appnexus":t.displayAdServer=n.displayAdServerAppNexus;break;case"googletag":t.displayAdServer=o.displayAdServerGoogletag;break;case"sas":t.displayAdServer=a.displayAdServerSAS;break;default:t.displayAdServer=i.displayAdServerDefault}};var n=r(25),o=r(12),i=r(26),a=r(27);t.displayAdServer=i.displayAdServerDefault},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.displayAdServerAppNexus=void 0;var n=r(0),o={isSupported:!0,needNewBidObject:!1,cmdQueuePush:function(e){window.apntag.anq.push(e)},setTargeting:function(e,t,r){void 0===r?window.apntag.requests.keywords[e]=t:r.keywords[e]=t},getTargeting:function(e,t){var r;return void 0===(r=void 0===t?((0,n.safeObjectHasProp)(window.apntag.requests,"keywords")||(window.apntag.requests.keywords={}),window.apntag.requests.keywords[e]):((0,n.safeObjectHasProp)(t,"keywords")||(t.keywords={}),t.keywords[e]))?[]:[r]},clearTargeting:function(e,t){void 0===t?delete window.apntag.requests.keywords[e]:delete t.keywords[e]},slotRenderEndedEvent:function(e){window.apntag.onEvent("adLoaded",e)},hasAdServerObjectLoaded:function(){return void 0!==window.apntag&&(0,n.safeObjectHasProp)(window.apntag,"loaded")&&!0===window.apntag.loaded},isCommandQueueDefined:function(){return void 0!==window.apntag&&void 0!==window.apntag.anq},getSlotElementId:function(e){return e.targetId},getSlots:function(){return Object.keys(window.apntag.requests.tags).map(function(e){return window.apntag.requests.tags[e]})},appendTargeting:function(){}};t.displayAdServerAppNexus=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.displayAdServerDefault={isSupported:!1,needNewBidObject:!1,cmdQueuePush:function(){},setToBeginningOfCmdQueue:function(){},setTargeting:function(){},getTargeting:function(){return[]},clearTargeting:function(){},slotRenderEndedEvent:function(){},hasAdServerObjectLoaded:function(){},isCommandQueueDefined:function(){},getSlotElementId:function(){},getSlots:function(){return[]},appendTargeting:function(){}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.displayAdServerSAS=void 0;var n=r(0),o={isSupported:!0,needNewBidObject:!0,cmdQueuePush:function(e){window.sas.cmd.push(e)},setTargeting:function(){},getTargeting:function(){return[]},clearTargeting:function(){},slotRenderEndedEvent:function(){},hasAdServerObjectLoaded:function(){return(0,n.safeObjectHasProp)(window,"sas")&&(0,n.safeObjectHasProp)(window.sas,"__smartLoaded")&&!0===window.sas.__smartLoaded},isCommandQueueDefined:function(){return!!(0,n.safeObjectHasProp)(window,"sas")&&(0,n.safeObjectHasProp)(window.sas,"cmd")},getSlotElementId:function(){},getSlots:function(){return[]},appendTargeting:function(e){e.forEach(function(e){(0,n.safeObjectHasProp)(e,"slotID")&&-1<e.slotID.indexOf("_")&&(e.sasTargeting=e.helpers.targetingKeys.reduce(function(t,r){return 0<t.length&&(t+=";"),t+r+"_"+e.slotID.split("_")[1]+"="+e.targeting[r]},""))})}};t.displayAdServerSAS=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e};t.buildBidUrl=function(e,t){var r=o.store.getState(),g={},m=(0,i.getDebugValue)("host",r.hosts.DEFAULT_AAX_BID_HOST),_=r.cfg.DTB_PATH,b={src:r.config.pubID,u:(0,f.getCurrentUrl)(window),pr:(0,f.getReferrerUrl)(window),pid:(0,l.getPageLoadID)(),cb:e.bidReqID,ws:(0,s.getWindowDimensions)(window),v:a.LIBRARY_VERSION,t:t,slots:function(e){return(0,c.objToUrlParam)(e.map(function(e){var t={};return(0,s.safeObjectHasProp)(e,"mediaType")&&"video"===e.mediaType?(t.id=e.slotID,t.mt=a.MEDIA_TYPES_MAGIC_STRING_FOR_AAX.video):(0,s.safeObjectHasProp)(e,"sizes")&&(t.sd=e.slotID,t.s=e.sizes.filter(s.isArray).map(function(e){return e.join("x")}),(0,s.safeObjectHasProp)(e,"slotName")&&e.slotName!==e.slotID&&(t.sn=e.slotName)),(0,s.safeObjectHasProp)(e,"slotParams")&&(0,u.isObject)(e.slotParams)&&(t.kv={},Object.keys(e.slotParams).forEach(function(r){!function e(t){return(0,s.isArray)(t)?t.reduce(function(t,r){return t&&e(r)},!0):"string"==typeof t&&0<t.length}(e.slotParams[r])||(t.kv[r]=e.slotParams[r])})),0===Object.keys(t).length?((0,d.reportError)({name:"Slot Error",message:"There was an error with the configuration for this slot: "+JSON.stringify(e)},"InvalidSlotError",!0),n({},e,{id:"error"})):t}).filter(function(e){return"error"!==e.id}))}(e.slots),pj:function(e,t){var r=e.config.params,o=t.params;r=(0,u.isObject)(r)?r:{},o=(0,u.isObject)(o)?o:{};var i=n({},r,o);return 0===Object.keys(i).length?null:(0,c.objToUrlParam)(i)}(r,e),cfgv:(0,f.getCfgVersion)(),bb:(0,f.getBlockedBidders)(e)};if(o.store.dispatch({type:"RECORD_AAX_REQUEST",data:{bidConfig:e,timeout:t,bidReqID:e.bidReqID,ws:b.ws,url:b.u,rqTs:Date.now()}}),r.experiments.chunkRequests){var h=e.bidReqID.split("-");o.store.dispatch({type:"RECORD_NETWORK_EXCHANGE",fid:h[0],networkID:h[1],timestamp:Date.now(),exchangeType:"request"})}r.config.isSelfServePub&&(b.pubid=b.src,b.src=600);var S=(0,f.getApsFirstPartyCookies)();S.fb&&(g[917]=S.fb,b[a.FIRST_PARTY_COOKIE_KEYS.aps_ext_917.urlParam]=(0,c.objToUrlParam)(g)),l.IS_RENDER_BIDDING_PAGELOAD&&(0,l.isFirstAAXRequest)(r)&&(b=n({},b,a.IS_GET_BIDS_URL_PARAM));var y=(0,i.getDebugValue)("bidParams");if((0,u.isObject)(y)&&(b=n({},b,y)),(0,u.isObject)(r.gdpr)){b.gdpre=encodeURIComponent(r.gdpr.enabled),b.gdprc=encodeURIComponent(r.gdpr.consent);var v=JSON.parse(r.gdpr.log);if((0,s.hasLocalStorage)()){var E=window.localStorage.getItem(p.cmpResponseKey);try{E=JSON.parse(E)}catch(e){E=null}window.localStorage.removeItem(p.cmpResponseKey),null!==E&&(v.rtimes=E);var O=window.localStorage.getItem(p.cmpLocalStorageChanged);null!==O&&(window.localStorage.removeItem(p.cmpLocalStorageChanged),v.cc=O)}b.gdprl=(0,c.objToUrlParam)(v)}var I=Object.keys(b).filter(function(e){return(0,s.safeObjectHasProp)(b,e)&&"undefined"!==b[e]&&""!==b[e]&&null!==b[e]}).map(function(e){return e+"="+b[e]}).join("&");return S.cookiesParams&&(I+=S.cookiesParams),""+a.PROTOCOL+m+_+"/bid?"+I};var o=r(2),i=r(4),a=r(1),s=r(0),c=r(7),u=r(29),d=r(3),l=r(13),f=r(6),p=r(8)},function(e,t,r){"use strict";(function(e){var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=Object.getOwnPropertyDescriptors||function(e){for(var t=Object.keys(e),r={},n=0;n<t.length;n++)r[t[n]]=Object.getOwnPropertyDescriptor(e,t[n]);return r},i=/%[sdj%]/g;t.format=function(e){if(!h(e)){for(var t=[],r=0;r<arguments.length;r++)t.push(c(arguments[r]));return t.join(" ")}r=1;for(var n=arguments,o=n.length,a=String(e).replace(i,function(e){if("%%"===e)return"%";if(o<=r)return e;switch(e){case"%s":return String(n[r++]);case"%d":return Number(n[r++]);case"%j":try{return JSON.stringify(n[r++])}catch(e){return"[Circular]"}default:return e}}),s=n[r];r<o;s=n[++r])_(s)||!v(s)?a+=" "+s:a+=" "+c(s);return a},t.deprecate=function(r,n){if(void 0!==e&&!0===e.noDeprecation)return r;if(void 0===e)return function(){return t.deprecate(r,n).apply(this,arguments)};var o=!1;return function(){if(!o){if(e.throwDeprecation)throw new Error(n);e.traceDeprecation,o=!0}return r.apply(this,arguments)}};var a,s={};function c(e,r){var n={seen:[],stylize:d};return 3<=arguments.length&&(n.depth=arguments[2]),4<=arguments.length&&(n.colors=arguments[3]),m(r)?n.showHidden=r:r&&t._extend(n,r),S(n.showHidden)&&(n.showHidden=!1),S(n.depth)&&(n.depth=2),S(n.colors)&&(n.colors=!1),S(n.customInspect)&&(n.customInspect=!0),n.colors&&(n.stylize=u),l(n,e,n.depth)}function u(e,t){var r=c.styles[t];return r?"["+c.colors[r][0]+"m"+e+"["+c.colors[r][1]+"m":e}function d(e,t){return e}function l(e,r,n){if(e.customInspect&&r&&I(r.inspect)&&r.inspect!==t.inspect&&(!r.constructor||r.constructor.prototype!==r)){var o=r.inspect(n,e);return h(o)||(o=l(e,o,n)),o}var i=function(e,t){if(S(t))return e.stylize("undefined","undefined");if(h(t)){var r="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(r,"string")}return b(t)?e.stylize(""+t,"number"):m(t)?e.stylize(""+t,"boolean"):_(t)?e.stylize("null","null"):void 0}(e,r);if(i)return i;var a=Object.keys(r),s=function(e){var t={};return a.forEach(function(e,r){t[e]=!0}),t}();if(e.showHidden&&(a=Object.getOwnPropertyNames(r)),O(r)&&(0<=a.indexOf("message")||0<=a.indexOf("description")))return f(r);if(0===a.length){if(I(r)){var c=r.name?": "+r.name:"";return e.stylize("[Function"+c+"]","special")}if(y(r))return e.stylize(RegExp.prototype.toString.call(r),"regexp");if(E(r))return e.stylize(Date.prototype.toString.call(r),"date");if(O(r))return f(r)}var u,d="",v=!1,D=["{","}"];return g(r)&&(v=!0,D=["[","]"]),I(r)&&(d=" [Function"+(r.name?": "+r.name:"")+"]"),y(r)&&(d=" "+RegExp.prototype.toString.call(r)),E(r)&&(d=" "+Date.prototype.toUTCString.call(r)),O(r)&&(d=" "+f(r)),0!==a.length||v&&0!=r.length?n<0?y(r)?e.stylize(RegExp.prototype.toString.call(r),"regexp"):e.stylize("[Object]","special"):(e.seen.push(r),u=v?function(e,t,r,n,o){for(var i=[],a=0,s=t.length;a<s;++a)A(t,String(a))?i.push(p(e,t,r,n,String(a),!0)):i.push("");return o.forEach(function(o){o.match(/^\d+$/)||i.push(p(e,t,r,n,o,!0))}),i}(e,r,n,s,a):a.map(function(t){return p(e,r,n,s,t,v)}),e.seen.pop(),function(e,t,r){return 60<e.reduce(function(e,t){return t.indexOf("\n"),e+t.replace(/\u001b\[\d\d?m/g,"").length+1},0)?r[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+r[1]:r[0]+t+" "+e.join(", ")+" "+r[1]}(u,d,D)):D[0]+d+D[1]}function f(e){return"["+Error.prototype.toString.call(e)+"]"}function p(e,t,r,n,o,i){var a,s,c;if((c=Object.getOwnPropertyDescriptor(t,o)||{value:t[o]}).get?s=c.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):c.set&&(s=e.stylize("[Setter]","special")),A(n,o)||(a="["+o+"]"),s||(e.seen.indexOf(c.value)<0?-1<(s=_(r)?l(e,c.value,null):l(e,c.value,r-1)).indexOf("\n")&&(s=i?s.split("\n").map(function(e){return"  "+e}).join("\n").substr(2):"\n"+s.split("\n").map(function(e){return"   "+e}).join("\n")):s=e.stylize("[Circular]","special")),S(a)){if(i&&o.match(/^\d+$/))return s;a=(a=JSON.stringify(""+o)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(a=a.substr(1,a.length-2),e.stylize(a,"name")):(a=a.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),e.stylize(a,"string"))}return a+": "+s}function g(e){return Array.isArray(e)}function m(e){return"boolean"==typeof e}function _(e){return null===e}function b(e){return"number"==typeof e}function h(e){return"string"==typeof e}function S(e){return void 0===e}function y(e){return v(e)&&"[object RegExp]"===D(e)}function v(e){return"object"===(void 0===e?"undefined":n(e))&&null!==e}function E(e){return v(e)&&"[object Date]"===D(e)}function O(e){return v(e)&&("[object Error]"===D(e)||e instanceof Error)}function I(e){return"function"==typeof e}function D(e){return Object.prototype.toString.call(e)}function A(e,t){return Object.prototype.hasOwnProperty.call(e,t)}t.debuglog=function(r){return S(a)&&(a=e.env.NODE_DEBUG||""),r=r.toUpperCase(),s[r]||(new RegExp("\\b"+r+"\\b","i").test(a)?(e.pid,s[r]=function(){t.format.apply(t,arguments)}):s[r]=function(){}),s[r]},(t.inspect=c).colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},c.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},t.isArray=g,t.isBoolean=m,t.isNull=_,t.isNullOrUndefined=function(e){return null==e},t.isNumber=b,t.isString=h,t.isSymbol=function(e){return"symbol"===(void 0===e?"undefined":n(e))},t.isUndefined=S,t.isRegExp=y,t.isObject=v,t.isDate=E,t.isError=O,t.isFunction=I,t.isPrimitive=function(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"===(void 0===e?"undefined":n(e))||void 0===e},t.isBuffer=r(31),t.log=function(){},t.inherits=r(32),t._extend=function(e,t){if(!t||!v(t))return e;for(var r=Object.keys(t),n=r.length;n--;)e[r[n]]=t[r[n]];return e};var T="undefined"!=typeof Symbol?Symbol("util.promisify.custom"):void 0;function w(e,t){if(!e){var r=new Error("Promise was rejected with a falsy value");r.reason=e,e=r}return t(e)}t.promisify=function(e){if("function"!=typeof e)throw new TypeError('The "original" argument must be of type Function');if(T&&e[T]){var t;if("function"!=typeof(t=e[T]))throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(t,T,{value:t,enumerable:!1,writable:!1,configurable:!0}),t}function t(){for(var t,r,n=new Promise(function(e,n){t=e,r=n}),o=[],i=0;i<arguments.length;i++)o.push(arguments[i]);o.push(function(e,n){e?r(e):t(n)});try{e.apply(this,o)}catch(n){r(n)}return n}return Object.setPrototypeOf(t,Object.getPrototypeOf(e)),T&&Object.defineProperty(t,T,{value:t,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(t,o(e))},t.promisify.custom=T,t.callbackify=function(t){if("function"!=typeof t)throw new TypeError('The "original" argument must be of type Function');function r(){for(var r=[],n=0;n<arguments.length;n++)r.push(arguments[n]);var o=r.pop();if("function"!=typeof o)throw new TypeError("The last argument must be of type Function");function i(){return o.apply(a,arguments)}var a=this;t.apply(this,r).then(function(t){e.nextTick(i,null,t)},function(t){e.nextTick(w,t,i)})}return Object.setPrototypeOf(r,Object.getPrototypeOf(t)),Object.defineProperties(r,o(t)),r}}).call(this,r(30))},function(e,t,r){"use strict";var n,o,i=e.exports={};function a(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function c(e){if(n===setTimeout)return setTimeout(e,0);if((n===a||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:a}catch(e){n=a}try{o="function"==typeof clearTimeout?clearTimeout:s}catch(e){o=s}}();var u,d=[],l=!1,f=-1;function p(){l&&u&&(l=!1,u.length?d=u.concat(d):f=-1,d.length&&g())}function g(){if(!l){var e=c(p);l=!0;for(var t=d.length;t;){for(u=d,d=[];++f<t;)u&&u[f].run();f=-1,t=d.length}u=null,l=!1,function(e){if(o===clearTimeout)return clearTimeout(e);if((o===s||!o)&&clearTimeout)return o=clearTimeout,clearTimeout(e);try{o(e)}catch(t){try{return o.call(null,e)}catch(t){return o.call(this,e)}}}(e)}}function m(e,t){this.fun=e,this.array=t}function _(){}i.nextTick=function(e){var t=new Array(arguments.length-1);if(1<arguments.length)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];d.push(new m(e,t)),1!==d.length||l||c(g)},m.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=_,i.addListener=_,i.once=_,i.off=_,i.removeListener=_,i.removeAllListeners=_,i.emit=_,i.prependListener=_,i.prependOnceListener=_,i.listeners=function(e){return[]},i.binding=function(e){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},function(e,t,r){"use strict";var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};e.exports=function(e){return e&&"object"===(void 0===e?"undefined":n(e))&&"function"==typeof e.copy&&"function"==typeof e.fill&&"function"==typeof e.readUInt8}},function(e,t,r){"use strict";"function"==typeof Object.create?e.exports=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:e.exports=function(e,t){function r(){}e.super_=t,r.prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e}}]);
//# sourceMappingURL=apstag.js.map