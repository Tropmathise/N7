package monopoly;

/**
 * Fonctions utiles lors d'un tour
 * @author Thibault
 *
 */
public class Tour {

	// ----- Atributs
	
	private JoueurMonopoly joueurActif; // Le joueur qui joue le tour
	/** Nombre de double r√©alis√© par le joueur actif */
	private int nombreDouble;
	/** Pr√©sence d'un double au dernier lanc√© */
	private boolean doubleDes;
	
	/**
	 * Constructeur du type Tour
	 * @param joueurActif le joueur qui joue le tour
	 */
	public Tour(JoueurMonopoly joueurActif) {
		this.joueurActif = joueurActif;
		this.nombreDouble = 0;
		this.doubleDes = false;
	}

	/*
	 * Renvoie la somme des d√©s lanc√©s (entre 1 et 12)
	 */
	private int lancerDes() {
		Des des = new Des(0,0);
		// R√©aliser un nouveau lancer
		//doubleDes = false;
		des.lancerDes();
		/*// V√©rifier la pr√©sence d'un double */
		if (des.getDe1() == des.getDe2()) {
			this.nombreDouble++;
			this.doubleDes = true;
		}
		if (nombreDouble == 3) {
			// TODO go prison
		}
		return des.getDe1() + des.getDe2();
		
	}

	/**
	 * D√©placer le joueur au d√©but du tour
	 * @param SommeDes la somme des d√©s obtenus
	 */
	private void deplacerJoueur(int SommeDes) {
		joueurActif.setPosition(Plateau.cases[(joueurActif.getPosition().id + SommeDes) % Plateau.nbCases]);
	}

	public void acheterPropriete(Carte carte) throws ImpayableException, ProprieteDejaPossedeeException {
		if (joueurActif.getSolde() < carte.getValeur()) {
			throw new ImpayableException("Vous n'avez pas assez d'argent pour acheter cette propri√©t√©");
		}
		// Si un autre joueur poss√®de la case, cette fonction n'est pas disponible, pas besoin de traiter cette exception
		// (on pourrait le faire plus haut).
	}
	
	/** R√©aliser le tour de jeu du joueur actif. Prends en compte
	 * les doubles faits, les cases sur lesquelles il s'arr√™te.
	 */
	public void realiserTour() {
		do {
			doubleDes = false;
			// Lancer les d√©s
			int valeur = this.lancerDes();
			// D√©placer le joueur
			UtilsTour.avancerDe(this.joueurActif, valeur);
			// RÈsoudre l'effet de la case
			
		} while (doubleDes);
		
	}
}