/** le plateau sur lequel se déplacent les joueurs 
 * @author Theo
 * @version 1.0
*/

package monopoly;

import java.io.IOException;
//import java.util.ArrayList;

import monopoly.cases.*;


public class Plateau {

    public static final Integer nbCartes = 16;
    public static final Integer nbCases = 40;
    private static final Integer nbLoyers = 6;
    private Integer tasArgent = 0;
    private int nbTours = 0;
    private static final Carte[] cartesChances = initCartes("res/CartesChance.txt");
    private static final Carte[] cartesCdC = initCartes("res/CartesCdC.txt");
    private static final Case[] cases = initCases("res/Cases.txt");



    /** Obtenir la valeur du tas amassé.
     * @return Integer tasArgent
     */
    public Integer getTasArgent() {
        return this.tasArgent;
    }

    /** Obtenir le nombre de tours.
     * @return Integer nbTours
     */
    public Integer getNbTour() {
        return this.nbTours;
    }

    public static Carte[] getChances() {
        return Plateau.cartesChances;
    }

    public static Carte[] getCdC() {
        return Plateau.cartesCdC;
    }

    public static Case[] getCases() {
        return Plateau.cases;
    }

    /** Modifier le tas d'argent amassé.
     * 
     * @param nvTas
     */
    public void setTasArgent(Integer nvTas) {
        this.tasArgent = nvTas;
    }

    /** Initialiser les cartes chance et caisse de communauté
     * @param fichier le chemin du fichier
     * @return Array de cartes
     */
    private static Carte[] initCartes(String fichier) {
        Carte[] cartes = new Carte[nbCartes];
        try {
            String[] donnees = Fichier.Lecture(fichier, nbCartes);
            for(int i = 0; i < nbCartes; i++) {
                String[] donneeCarte = donnees[i].split("@");
                cartes[i] = new Carte(Integer.parseInt(donneeCarte[0]), TypeCarte.fromString(donneeCarte[1]), Integer.parseInt(donneeCarte[2]), donneeCarte[3]);
            }
        }
        catch(IOException e) {
            System.out.println("Partie.java IOException. " + e.getMessage());
        }
        catch(NumberFormatException e) {
            System.out.println("Partie.java FORMAT. " + e.getMessage());
        }
        return cartes;
    }

    /** Initialiser les cases du plateau.
     * @param fichier le chemin du fichier
     * @return Array de cases
     */
    private static Case[] initCases(String fichier) {
        Case[] cases = new Case[nbCases];
        try {
            String[] donnees = Fichier.Lecture(fichier, nbCases);
            for(int i = 0; i < nbCases; i++) {
                String[] donneeCase = donnees[i].split("@");
                Integer[] loyer = new Integer[nbLoyers];
                switch (donneeCase[1]) {
                    case "PROPRIETE":
                        String[] loyerstr = donneeCase[5].split(",");
                        for (int j = 0; j < nbLoyers; j++) {
                            loyer[j] = Integer.parseInt(loyerstr[j]);
                        }
                        cases[i] = new Propriete(Integer.parseInt(donneeCase[0]), TypeCase.fromString(donneeCase[1]),
                        donneeCase[2], Integer.parseInt(donneeCase[3]), Integer.parseInt(donneeCase[4]), loyer);
                        break;
                    case "GARE":
                        cases[i] = new Gare(Integer.parseInt(donneeCase[0]), TypeCase.fromString(donneeCase[1]),
                        donneeCase[2], Integer.parseInt(donneeCase[3]));
                        break;
                    case "COMPAGNIE":
                        cases[i] = new Compagnie(Integer.parseInt(donneeCase[0]), donneeCase[2]);
                        break;
                    case "CDC":
                        cases[i] = new Case(Integer.parseInt(donneeCase[0]), TypeCase.fromString(donneeCase[1]),
                        donneeCase[2]);
                        break;
                    case "CHANCE":
                        cases [i] = new Case(Integer.parseInt(donneeCase[0]), TypeCase.fromString(donneeCase[1]),
                        donneeCase[2]);
                        break;
                    case "PRISON":
                        cases [i] = new Case(Integer.parseInt(donneeCase[0]), TypeCase.fromString(donneeCase[1]),
                        donneeCase[2]);
                        break;
                    case "GOPRISON":
                        cases[i] = new Case(Integer.parseInt(donneeCase[0]), TypeCase.fromString(donneeCase[1]),
                        donneeCase[2]);
                        break;
                    case "PARC":
                        cases[i] = new Case(Integer.parseInt(donneeCase[0]), TypeCase.fromString(donneeCase[1]),
                        donneeCase[2]);
                        break;
                    case "DEPART":
                        cases[i] = new Case(Integer.parseInt(donneeCase[0]), TypeCase.fromString(donneeCase[1]),
                        donneeCase[2]);
                        break;
                    case "PAIEMENT":
                        cases[i] = new Case(Integer.parseInt(donneeCase[0]), TypeCase.fromString(donneeCase[1]),
                        donneeCase[2]);
                        break;
                    default:
                        System.out.println("Le type de case est inconnu");
                }
                
            }
        }
        catch(IOException e) {
            System.out.println("Partie.java IOException. " + e.getMessage());
        }
        catch(NumberFormatException e) {
            System.out.println("Partie.java FORMAT. " + e.getMessage());
        }
        return cases;
    }
}